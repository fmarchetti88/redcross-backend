{"version":3,"sources":["serviceWorker.ts","actions/action.tsx","utils/Constants.tsx","components/mobile/base/TripsList.tsx","utils/Utils.tsx","utils/Connector.tsx","reducers/reducers.tsx","utils/Links.tsx","components/common/Login.tsx","components/desktop/base/PlusFabButton.tsx","dto/TripDTO.tsx","dto/VehicleDTO.tsx","components/desktop/forms/TripForm.tsx","components/desktop/forms/DuplicateTripForm.tsx","components/desktop/base/DayOfWeek.tsx","components/desktop/base/DaysOfWeek.tsx","components/desktop/base/ServiceCalendar.tsx","components/desktop/base/ServiceViewMode.tsx","dto/TripUsersDTO.tsx","components/desktop/base/RoleChoose.tsx","components/desktop/base/ServiceTimeline.tsx","components/desktop/Services.tsx","dto/UserDTO.tsx","components/desktop/forms/UserForm.tsx","components/common/ChangePasswordModal.tsx","components/desktop/PersonalArea.tsx","components/desktop/layouts/base/RedCrossMenu.tsx","components/desktop/layouts/RedCrossSider.tsx","components/desktop/layouts/RedCrossHeader.tsx","components/desktop/layouts/RedCrossFooter.tsx","components/desktop/Users.tsx","components/desktop/forms/VehicleForm.tsx","components/desktop/Vehicles.tsx","components/desktop/Dashboard.tsx","components/mobile/PersonalAreaMobile.tsx","components/mobile/DashboardMobile.tsx","App.tsx","index.tsx"],"names":["Boolean","window","location","hostname","match","ReduxActionTypes","setUsersData","users","type","SET_USERS_DATA","data","setUserData","user","committeeId","SET_USER_DATA","resetAuthData","RESET_AUTH_DATA","ViewModeType","TripListType","WeekDays","Months","getUserInfo","loggedUserInfo","localStorage","getItem","JSON","parse","resetUserInfo","removeItem","getTripsOfDate","date","trips","filter","trip","Date","setHours","filterTripsByOccupation","sort","trip1","trip2","hour1Replaced","hour","split","join","hour2Replaced","Number","undefined","committeeUser","occupation","compareTripUsers","a","b","role","getRoleBackgroundColor","Connector","axiosInstance","authHeader","userInfo","accessToken","baseURL","origin","this","axios","create","headers","call","operation","vehicle","id","body","stringify","tripId","tripUserId","userId","tripUser","committeeUserId","oldPassword","newPassword","committeeUserInfo","publishUser","userResponse","status","console","log","Error","publishedUser","disabled","bodyCommUser","operationCommUser","username","password","tempInstance","url","method","hash","btoa","Authorization","stateDefault","committee","connector","showLoading","AppReducers","combineReducers","appData","state","action","SET_ACCESS_TOKEN","normalizedUser","committee_users","find","committee_user","newState","SET_COMMITTEE_DATA","SET_SHOW_LOADING","normalizedUsers","map","userToNormalize","Links","Option","Select","LoginForm","props","handleSelectChange","value","form","setFieldsValue","buildCommitteesSelect","committees","length","getFieldDecorator","Item","rules","required","message","onChange","key","description","login","isForMobile","getUser","then","res","founded","element","setCommitteeData","getUsers","uRes","success","history","replace","catch","uErr","error","err","handleSubmit","e","preventDefault","validateFields","values","setState","loading","signin","setItem","errorMessage","response","pathname","getCommittees","visible","closable","confirmLoading","footer","style","textAlign","gutter","span","alt","src","width","onSubmit","className","prefix","color","placeholder","htmlType","React","WrappeLoginForm","Form","name","LoginContainer","connect","ownProps","setAccessToken","PlusFabButton","mainButtonStyles","backgroundColor","alwaysShowTitle","event","icon","position","bottom","right","onClick","ServiceTargetRoleType","0","1","ServiceTargetLocationType","2","FlgArType","VehicleType","Trip","dateForHour","substring","formValues","tripDate","moment","tripHour","vehicleId","tripToSave","format","onSave","buildVehicleOptions","actualVehicles","vehicles","sign","nextProps","onClose","title","bodyStyle","paddingBottom","layout","label","TextArea","rows","Group","marginTop","valuePropName","initialValue","min","max","visibility","borderTop","padding","background","marginRight","TripContainer","TripForm","DuplicateTrip","onDeleteDate","k","keys","getFieldValue","duplicateElements","index","onAddDate","nextKeys","concat","onConfirm","getInitialDateValue","tripToDuplicate","add","getInitialHourValue","myFormItems","DuplicateTripContainer","DuplicateTripForm","today","DayOfWeek","dayOfMonth","getDate","month","getMonth","todayTrips","weekDay","getDay","count","marginLeft","selectedDate","onClickDayOfWeek","isSelected","getFullYear","isOld","getTime","isToday","size","renderCardHeaderDate","cursor","borderRadius","height","border","renderCardBodyWeekDay","DaysOfWeek","renderDaysOfWeek","startDate","rowIndex","elements","uniqueIndex","actualDate","days","tripsOfDate","push","justify","ServiceCalendar","renderDays","viewMode","firstDayOfView","onMoveViewLeft","onMoveViewRight","numRows","week","row","margin","ServiceViewMode","actualValue","onChangeView","defaultValue","target","Button","ServiceRoleType","RoleChoose","_onChangeRole","roleSelected","_onChangeUser","userSelected","getAvailableUsers","tripUsers","isUserAdmin","loggedUser","_onConfirmRole","onConfirmRole","initialUser","avilabledUsers","buttonStyle","withDrivingLicense","surname","ghost","ServiceTimeline","renderTooltipUserAvatar","trip_user","onDeleteTripUser","renderRoleChoose","committeeUsers","renderTimeline","rolesVisible","onEditTrip","onDuplicateTrip","onDeleteTrip","onRoleVisibleChange","maximumUsers","reduce","p","v","extraUsers","sharedSpan","Math","floor","trip_users","totalUsers","popoverVisible","zIndex","shape","fontSize","content","trigger","onVisibleChange","substr","flgDestination","siteDeparture","siteArrival","flgAr","flgNurse","patientData","serviceType","notes","placement","okText","cancelText","Services","showForm","showDuplicateTripForm","selectedTrip","getEmptyTrip","flgToNotify","loadData","getTrips","getVehicles","vRes","vErr","_onChangeView","_onClickDayOfWeek","_onDeleteTrip","deleteTripUsersByTrip","deleteTrip","tRes","tErr","_onEditTrip","_onDuplicateTrip","_onDeleteTripUser","deleteTripUsers","tripToPublish","newRolesVisible","publishTripUser","_onRoleVisibleChange","roleVisible","newArray","_onCreate","_onCloseTripForm","_onCloseDuplicateTripForm","_onConfirmDuplicateTrip","newDates","withError","newDate","newTrip","publishTrip","_onSave","_onMoveViewRight","newFirstDayOfView","_onMoveViewLeft","Component","ServicesContainer","UserRoleType","UserOccupationType","3","UserGenderType","formItemLayout","labelCol","xs","sm","wrapperCol","tailLayout","offset","User","getInitialValueBirthDate","birth_date","userToSave","renderButtonSubmit","btnStyle","float","personalArea","renderPasswordField","Password","onCancel","onChangePassword","lg","gender","email","cellphoneNumber","flgPasswordChanged","UserContainer","UserForm","ChangePasswordModal","newPasswordConfirm","onChangeOldPassowrd","onChangeNewPassword","onChangeNewPasswordConfirm","handlePasswordChangeConfirm","onPasswordChangeConfirm","changePasswordModalVisible","handlePasswordChangeCancel","onPasswordChangeCancel","onOk","PersonalArea","passwordChangeFormVisible","_onCancel","goBack","userToPublish","_onChangePassword","_onPasswordChangeConfirm","modifyPassword","_onPasswordChangeCancel","loggedUserId","PersonalAreaContainer","RedCrossMenu","onClickMenuItem","link","onClickMenu","menuMode","theme","defaultSelectedKeys","mode","Sider","Layout","RedCrossSider","_onCollapse","collapsed","_onClickMenu","collapsible","onCollapse","Header","RedCrossHeader","onClickLogout","maxHeight","left","fontStyle","Footer","RedCrossFooter","Users","columns","dataIndex","render","record","text","_onEditRow","_onDeleteUser","emptyUser","superuser","_onClose","selectedUser","getUserTrips","deleteCommitteesUsers","deleteUser","warn","publishUserCommittee","getDataSource","pagination","pageSize","dataSource","UsersContainer","Vehicle","vehicleToSave","plate","VehicleContainer","VehicleForm","Vehicles","_onEditVehicle","_onDeleteVehicle","emptyVehicle","selectedVehicle","deleteVehicle","publishVehicle","VehiclesContainer","Content","Dashboard","_onClickLogout","_onLogout","windowWidth","windowHeight","updateDimensions","addEventListener","bind","removeEventListener","innerWidth","innerHeight","minHeight","isForDesktop","path","exact","component","DashboardContainer","PersonalAreaMobile","onSaveUser","_onSubmit","allErrors","propertyError","errors","allError","getPickerGenderData","renderButtonChangePassword","toDate","getFieldProps","locale","enUS","renderHeader","display","clear","minDate","maxDate","dismissText","arrow","cols","PersonalAreaMobileForm","createForm","PersonalAreaMobileContainer","RightTopMenuChoise","TripsList","roles","buildDataBlobs","dataBlobs","sectionIDs","rowIDs","grouped","groupBy","sections","Object","i","j","rv","x","renderSeparator","sectionID","rowID","adjacentRowHighlighted","borderBottom","uuidv4","c","r","random","toString","renderSectionWrapper","renderSectionHeader","sectionData","sectionId","formattedDate","pad","s","renderRow","rowData","highlightRow","tripListType","percentage","showBookingUsers","toBook","showBookingRoles","cancelBookTrip","onCancelBookTrip","config","options","cancelButtonText","ActionSheet","showShareActionSheetWithOptions","roleId","showActionSheetWithOptions","destructiveButtonIndex","maskClosable","onBookTrip","info","renderFooter","myDataBlobs","ListView","DataSource","getRowData","dataBlob","getSectionHeaderData","rowHasChanged","row1","row2","sectionHeaderHasChanged","s1","s2","cloneWithRowsAndSections","initialListSize","useBodyScroll","onScroll","scrollEventThrottle","alert","Modal","Popover","DashboardMobile","isLoading","allTrips","getAvailableTrips","getBookedTrips","Promise","all","results","availableTrips","bookedTrips","_onCancelBookTrip","onPress","_onClickCancelBookTrip","tripUserToDelete","_onBookTrip","_onSelectRightTopMenu","node","Logout","rightTopMenuVisible","_rightTopMenuVisibleChange","selectedTab","hidden","booked","leftContent","fontWeight","rightContent","overlay","onSelect","alignItems","top","unselectedTintColor","tintColor","barTintColor","tabBarPosition","prerenderingSiblingsNumber","selectedIcon","selected","badge","data-seed","renderTabContent","DashboardMobileContainer","App","configureStore","createStore","ReactDOM","store","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b9bf532c.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import CommitteeDTO from '../dto/CommitteeDTO';\r\nimport UserDTO from '../dto/UserDTO';\r\n\r\nexport enum ReduxActionTypes {\r\n  SET_SHOW_LOADING = 'SET_SHOW_LOADING',\r\n  SET_USER_DATA = 'SET_USER_DATA',\r\n  SET_ACCESS_TOKEN = 'SET_ACCESS_TOKEN',\r\n  SET_COMMITTEE_DATA = 'SET_COMMITTEE_DATA',\r\n  RESET_AUTH_DATA = 'RESET_AUTH_DATA',\r\n  SET_USERS_DATA = 'SET_USERS_DATA'\r\n}\r\n\r\nexport interface ReduxBaseAction {\r\n  type: ReduxActionTypes;\r\n}\r\n\r\nexport interface ReduxSetUserData extends ReduxBaseAction {\r\n  type: ReduxActionTypes.SET_USER_DATA;\r\n  data: {\r\n    user: UserDTO;\r\n    committeeId: number;\r\n  };\r\n}\r\n\r\nexport interface ReduxSetAccessToken extends ReduxBaseAction {\r\n  type: ReduxActionTypes.SET_ACCESS_TOKEN;\r\n  data: {\r\n    accessToken: string;\r\n  };\r\n}\r\n\r\nexport interface ReduxSetCommitteeData extends ReduxBaseAction {\r\n  type: ReduxActionTypes.SET_COMMITTEE_DATA;\r\n  data: {\r\n    committee: CommitteeDTO;\r\n  };\r\n}\r\n\r\nexport interface ReduxSetUsersData extends ReduxBaseAction {\r\n  type: ReduxActionTypes.SET_USERS_DATA;\r\n  data: {\r\n    users: UserDTO[];\r\n  };\r\n}\r\n\r\nexport interface ReduxSetShowLoading extends ReduxBaseAction {\r\n  type: ReduxActionTypes.SET_SHOW_LOADING;\r\n  data: boolean;\r\n}\r\n\r\nexport interface ReduxResetAuthData extends ReduxBaseAction {\r\n  type: ReduxActionTypes.RESET_AUTH_DATA;\r\n}\r\n\r\nexport type TReducerActions =\r\n  | ReduxSetUserData\r\n  | ReduxSetAccessToken\r\n  | ReduxSetCommitteeData\r\n  | ReduxSetShowLoading\r\n  | ReduxResetAuthData\r\n  | ReduxSetUsersData;\r\n\r\nexport interface SetUsersDataProps {\r\n  setUsersData(users: UserDTO[]): ReduxSetUsersData;\r\n}\r\n\r\nexport interface SetUserDataProps {\r\n  setUserData(user: UserDTO, committeeId: number): ReduxSetUserData;\r\n}\r\n\r\nexport interface SetAccessTokenProps {\r\n  setAccessToken(accessToken: string): ReduxSetAccessToken;\r\n}\r\n\r\nexport interface SetCommitteeDataProps {\r\n  setCommitteeData(committee: CommitteeDTO): ReduxSetCommitteeData;\r\n}\r\n\r\nexport interface ResetAuthDataProps {\r\n  resetAuthData(): ReduxResetAuthData;\r\n}\r\n\r\nexport function setUsersData(users: UserDTO[]): ReduxSetUsersData {\r\n  return {\r\n    type: ReduxActionTypes.SET_USERS_DATA,\r\n    data: {\r\n      users\r\n    }\r\n  };\r\n}\r\n\r\nexport function setUserData(user: UserDTO, committeeId: number): ReduxSetUserData {\r\n  return {\r\n    type: ReduxActionTypes.SET_USER_DATA,\r\n    data: {\r\n      user,\r\n      committeeId\r\n    }\r\n  };\r\n}\r\n\r\nexport function setAccessToken(accessToken: string): ReduxSetAccessToken {\r\n  return {\r\n    type: ReduxActionTypes.SET_ACCESS_TOKEN,\r\n    data: {\r\n      accessToken\r\n    }\r\n  };\r\n}\r\n\r\nexport function setCommitteeData(committee: CommitteeDTO): ReduxSetCommitteeData {\r\n  return {\r\n    type: ReduxActionTypes.SET_COMMITTEE_DATA,\r\n    data: {\r\n      committee\r\n    }\r\n  };\r\n}\r\n\r\nexport function resetAuthData(): ReduxResetAuthData {\r\n  return {\r\n    type: ReduxActionTypes.RESET_AUTH_DATA\r\n  };\r\n}\r\n","export const PORTAL_NAME: string = 'Servizio Facile v.1.0';\r\nexport const LOGGED_USER_INFO_LOCAL_STORAGE_KEY: string = 'redcross-logged-userinfo';\r\nexport const MAXIMUM_WIDTH_FOR_SMARTPHONE: number = 768;\r\nexport const MAXIMUM_WIDTH_FOR_TABLET: number = 1100;\r\n\r\nexport enum ViewModeType {\r\n  week,\r\n  month\r\n}\r\n\r\nexport const WeekDays: Array<string> = ['Domenica', 'Lunedì', 'Martedì', 'Mercoledì', 'Giovedì', 'Venerdì', 'Sabato'];\r\n\r\nexport const Months: Array<string> = [\r\n  'Gennaio',\r\n  'Febbraio',\r\n  'Marzo',\r\n  'Aprile',\r\n  'Maggio',\r\n  'Giugno',\r\n  'Luglio',\r\n  'Agosto',\r\n  'Settembre',\r\n  'Ottobre',\r\n  'Novembre',\r\n  'Dicembre'\r\n];\r\n","import * as React from 'react';\r\nimport { StickyContainer, Sticky } from 'react-sticky';\r\nimport { ListView, Button, ActionSheet } from 'antd-mobile';\r\nimport './TripsList.css';\r\nimport TripDTO, { ServiceTargetLocationType } from '../../../dto/TripDTO';\r\nimport { WeekDays } from '../../../utils/Constants';\r\nimport Tag from 'antd/lib/tag';\r\nimport { VehicleType } from '../../../dto/VehicleDTO';\r\nimport { message, Avatar } from 'antd';\r\nimport TripUsersDTO, { ServiceRoleType } from '../../../dto/TripUsersDTO';\r\nimport { compareTripUsers, getRoleBackgroundColor } from '../../../utils/Utils';\r\nimport UserDTO from '../../../dto/UserDTO';\r\n\r\nexport enum TripListType {\r\n  toBook,\r\n  booked\r\n}\r\n\r\ninterface TripsListState {\r\n  dataSource: any;\r\n}\r\n\r\ninterface TripsListProps {\r\n  trips: TripDTO[];\r\n  tripListType: TripListType;\r\n  user: UserDTO | undefined;\r\n  onBookTrip?: (trip: TripDTO, roleId: number, userId: number) => void;\r\n  onCancelBookTrip?: (trip: TripDTO) => void;\r\n}\r\n\r\nconst cancelRoleId: number = 999;\r\n\r\nclass TripsList extends React.Component<TripsListProps, TripsListState> {\r\n  roles: Array<{ roleId: number; role: string }> = [];\r\n\r\n  constructor(props: any) {\r\n    super(props);\r\n    const getSectionData = (dataBlob: any, sectionID: any) => dataBlob[sectionID];\r\n    const getRowData = (dataBlob: any, sectionID: any, rowID: any) => dataBlob[rowID];\r\n\r\n    const myDataBlobs = this.buildDataBlobs(props.trips);\r\n    const { dataBlobs, sectionIDs, rowIDs } = myDataBlobs;\r\n    let dataSource = new ListView.DataSource({\r\n      getRowData,\r\n      getSectionHeaderData: getSectionData,\r\n      rowHasChanged: (row1: any, row2: any) => row1 !== row2,\r\n      sectionHeaderHasChanged: (s1: any, s2: any) => s1 !== s2\r\n    });\r\n    dataSource = dataSource.cloneWithRowsAndSections(dataBlobs, sectionIDs, rowIDs);\r\n    this.state = {\r\n      dataSource\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: TripsListProps) {\r\n    const { trips } = nextProps;\r\n    const myDataBlobs = this.buildDataBlobs(trips);\r\n    const { dataBlobs, sectionIDs, rowIDs } = myDataBlobs;\r\n    this.setState({\r\n      dataSource: this.state.dataSource.cloneWithRowsAndSections(dataBlobs, sectionIDs, rowIDs)\r\n    });\r\n  }\r\n\r\n  private buildDataBlobs = (trips: TripDTO[]): { dataBlobs: any; sectionIDs: any; rowIDs: any } => {\r\n    let dataBlobs: any = {};\r\n    let sectionIDs: any = [];\r\n    let rowIDs: any = [];\r\n    if (!trips || trips.length === 0) {\r\n      return { dataBlobs, sectionIDs, rowIDs };\r\n    }\r\n    const grouped: any = this.groupBy(trips, 'date');\r\n    const sections: string[] = Object.keys(grouped);\r\n    for (let i = 0; i < sections.length; i++) {\r\n      const date = sections[i];\r\n      sectionIDs.push(date);\r\n      dataBlobs[date] = date;\r\n      rowIDs[i] = [];\r\n\r\n      const tripsOfDate: TripDTO[] = grouped[date];\r\n      for (let j = 0; j < tripsOfDate.length; j++) {\r\n        const tripOfDate: TripDTO = tripsOfDate[j];\r\n        const tripId = tripOfDate.id;\r\n        rowIDs[i].push(tripId);\r\n        dataBlobs[tripId] = tripId;\r\n      }\r\n    }\r\n    sectionIDs = [...sectionIDs];\r\n    rowIDs = [...rowIDs];\r\n    return {\r\n      dataBlobs,\r\n      sectionIDs,\r\n      rowIDs\r\n    };\r\n  };\r\n\r\n  private groupBy = (trips: TripDTO[], key: string) => {\r\n    if (trips.length === 0) {\r\n      return {};\r\n    }\r\n    return trips.reduce((rv: any, x: any) => {\r\n      (rv[x[key]] = rv[x[key]] || []).push(x);\r\n      return rv;\r\n    }, {});\r\n  };\r\n\r\n  private renderSeparator = (sectionID: string | number, rowID: string | number, adjacentRowHighlighted?: boolean): React.ReactElement<any> => (\r\n    <div\r\n      key={`${sectionID}-${rowID}`}\r\n      style={{\r\n        backgroundColor: '#F5F5F9',\r\n        height: 15,\r\n        borderTop: '1px solid #ECECED',\r\n        borderBottom: '1px solid #ECECED'\r\n      }}\r\n    />\r\n  );\r\n\r\n  private uuidv4 = () => {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n      var r = (Math.random() * 16) | 0,\r\n        v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n      return v.toString(16);\r\n    });\r\n  };\r\n\r\n  private renderSectionWrapper = (): React.ReactElement<any> => <StickyContainer key={this.uuidv4()} className=\"sticky-container\" style={{ zIndex: 4 }} />;\r\n\r\n  private renderSectionHeader = (sectionData: string, sectionId: string | number): React.ReactElement<any> => {\r\n    const date = new Date(sectionData);\r\n    const weekDay: string = WeekDays[date.getDay()];\r\n    const formattedDate = [this.pad(date.getDate()), this.pad(date.getMonth() + 1), date.getFullYear()].join('/');\r\n    return (\r\n      <Sticky>\r\n        {({ style }) => (\r\n          <div\r\n            className=\"sticky\"\r\n            style={{\r\n              ...style,\r\n              marginTop: '45px',\r\n              zIndex: 4,\r\n              backgroundColor: '#F8591A' /* '#5890ff', */,\r\n              color: 'white'\r\n            }}\r\n          >\r\n            {formattedDate} - {weekDay}\r\n          </div>\r\n        )}\r\n      </Sticky>\r\n    );\r\n  };\r\n\r\n  private pad = (s: any) => {\r\n    return s < 10 ? '0' + s : s;\r\n  };\r\n\r\n  private renderRow = (rowData: any, sectionID: string | number, rowID: string | number, highlightRow?: boolean): React.ReactElement<any> => {\r\n    const { trips, tripListType } = this.props;\r\n    const trip: TripDTO | undefined = trips.find((x) => x.id === rowID);\r\n    if (trip !== undefined) {\r\n      const { vehicle, trip_users } = trip;\r\n      const tripUsers = (trip_users || []).length;\r\n      const totalUsers = trip.extraUsers + 1;\r\n      const percentage = (tripUsers * 100) / totalUsers;\r\n      return (\r\n        <div key={rowID} style={{ padding: '0 15px' }}>\r\n          <div\r\n            style={{\r\n              textAlign: 'right',\r\n              borderBottom: '2px solid #F6F6F6'\r\n            }}\r\n          >\r\n            <Tag style={{ marginLeft: '5px' }} color=\"green\">\r\n              {ServiceTargetLocationType[trip.flgDestination]}\r\n            </Tag>{' '}\r\n            <b>{trip.hour.substr(0, 5)}</b>\r\n          </div>\r\n          <div\r\n            style={{\r\n              textAlign: 'left',\r\n              borderBottom: '2px solid #F6F6F6'\r\n            }}\r\n          >\r\n            <b>Partenza:</b> {trip.siteDeparture}\r\n          </div>\r\n          <div\r\n            style={{\r\n              textAlign: 'left',\r\n              borderBottom: '2px solid #F6F6F6'\r\n            }}\r\n          >\r\n            <b>Arrivo:</b> {trip.siteArrival}\r\n          </div>\r\n          <div\r\n            style={{\r\n              textAlign: 'left',\r\n              borderBottom: '2px solid #F6F6F6'\r\n            }}\r\n          >\r\n            <b>Veicolo: </b> {!!vehicle ? `${VehicleType[vehicle.type]} - ${vehicle.sign} - ${vehicle.description}` : '-'}\r\n          </div>\r\n          <div\r\n            style={{\r\n              textAlign: 'left'\r\n            }}\r\n          >\r\n            <div>\r\n              <b>Servizio:</b> {trip.serviceType}\r\n            </div>\r\n            <div>\r\n              <b>Note:</b> {trip.notes}\r\n            </div>\r\n          </div>\r\n          <div\r\n            style={{\r\n              textAlign: 'right'\r\n            }}\r\n          >\r\n            N° posti disponibili{' '}\r\n            <Tag color={percentage >= 50 ? 'orange' : 'green'} onClick={() => this.showBookingUsers(trip)}>\r\n              {(trip_users || []).length}/<b>{trip.extraUsers + 1}</b>\r\n            </Tag>\r\n          </div>\r\n          {tripListType === TripListType.toBook ? (\r\n            <Button style={{ marginTop: '5px' }} type=\"primary\" icon=\"check-circle\" size=\"small\" onClick={() => this.showBookingRoles(trip)}>\r\n              Prenota\r\n            </Button>\r\n          ) : (\r\n            <Button style={{ marginTop: '5px' }} type=\"warning\" icon=\"cross-circle-o\" size=\"small\" onClick={() => this.cancelBookTrip(trip)}>\r\n              Annulla prenotazione\r\n            </Button>\r\n          )}\r\n        </div>\r\n      );\r\n    } else {\r\n      return <div>Data not loaded!</div>;\r\n    }\r\n  };\r\n\r\n  private cancelBookTrip = (trip: TripDTO) => {\r\n    const { onCancelBookTrip } = this.props;\r\n    if (onCancelBookTrip !== undefined) {\r\n      onCancelBookTrip(trip);\r\n    }\r\n  };\r\n\r\n  private showBookingUsers = (trip: TripDTO) => {\r\n    const tripUsers: TripUsersDTO[] = trip.trip_users || [];\r\n    if (tripUsers.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const shareOptions: any[] = tripUsers.sort(compareTripUsers).map((tripUser: TripUsersDTO) => {\r\n      return {\r\n        icon: <Avatar style={{ backgroundColor: getRoleBackgroundColor(tripUser.role) }} shape=\"square\" icon=\"user\" />,\r\n        title: (\r\n          <span>\r\n            {tripUser.user?.name || ''} {tripUser.user?.surname || ''} <b>({ServiceRoleType[tripUser.role]})</b>\r\n          </span>\r\n        )\r\n      };\r\n    });\r\n\r\n    const config: any = {\r\n      options: shareOptions,\r\n      title: 'Utenti prenotati al servizio',\r\n      className: 'my-saswo-class',\r\n      cancelButtonText: 'Chiudi'\r\n    };\r\n    ActionSheet.showShareActionSheetWithOptions(config);\r\n  };\r\n\r\n  private showBookingRoles = (trip: TripDTO) => {\r\n    const { user } = this.props;\r\n    const { trip_users } = trip;\r\n    if (trip.extraUsers + 1 === trip_users?.length) {\r\n      message.info('Servizio al completo');\r\n      return;\r\n    }\r\n\r\n    this.roles = [];\r\n    this.roles.push({ roleId: 1, role: 'Soccorritore' });\r\n    if (user !== undefined) {\r\n      if (user.withDrivingLicense > 0) {\r\n        this.roles = [{ roleId: 0, role: 'Autista' }, ...this.roles];\r\n      }\r\n      const { committeeUser } = user;\r\n      const { occupation } = committeeUser;\r\n      if (occupation === 2 && trip.flgNurse > 0) {\r\n        this.roles = [...this.roles, { roleId: 2, role: 'Medico/Sanitario' }];\r\n      }\r\n    }\r\n    this.roles = [...this.roles, { roleId: cancelRoleId, role: 'Annulla' }];\r\n    const options = this.roles.map((element: { roleId: number; role: string }) => element.role);\r\n    ActionSheet.showActionSheetWithOptions(\r\n      {\r\n        options,\r\n        destructiveButtonIndex: options.length - 1,\r\n        message: 'Seleziona il ruolo',\r\n        maskClosable: true\r\n      },\r\n      (index: number, rowIndex?: number) => {\r\n        if (index === -1) {\r\n          return;\r\n        }\r\n        const { roleId } = this.roles[index];\r\n        if (roleId === cancelRoleId) {\r\n          return;\r\n        }\r\n        const { onBookTrip } = this.props;\r\n        if (onBookTrip !== undefined) {\r\n          onBookTrip(trip, roleId, user?.id || 0);\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  private renderFooter = (): React.ReactElement<any> => (\r\n    <div></div>\r\n    // <div style={{ padding: 30, textAlign: 'center' }}>{this.state.isLoading ? 'Caricamento in corso...' : ''}</div>\r\n  );\r\n\r\n  public render() {\r\n    const { dataSource } = this.state;\r\n    return (\r\n      <ListView\r\n        dataSource={dataSource}\r\n        className=\"am-list sticky-list\"\r\n        initialListSize={this.props.trips.length}\r\n        useBodyScroll\r\n        renderSectionWrapper={this.renderSectionWrapper}\r\n        renderSectionHeader={this.renderSectionHeader}\r\n        renderFooter={this.renderFooter}\r\n        renderRow={this.renderRow}\r\n        renderSeparator={this.renderSeparator}\r\n        onScroll={() => {\r\n          console.log('scroll');\r\n        }}\r\n        scrollEventThrottle={200}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default TripsList;\r\n","import LoggedUserInfoDTO from '../dto/LoggedUserInfoDTO';\r\nimport { LOGGED_USER_INFO_LOCAL_STORAGE_KEY } from './Constants';\r\nimport TripDTO from '../dto/TripDTO';\r\nimport UserDTO from '../dto/UserDTO';\r\nimport TripUsersDTO from '../dto/TripUsersDTO';\r\n\r\nexport const setUserInfo = (userInfo: string) => {\r\n  localStorage.setItem(LOGGED_USER_INFO_LOCAL_STORAGE_KEY, JSON.stringify(userInfo));\r\n};\r\n\r\nexport const getUserInfo = (): LoggedUserInfoDTO | undefined => {\r\n  const loggedUserInfo: string | null = localStorage.getItem(LOGGED_USER_INFO_LOCAL_STORAGE_KEY);\r\n  if (loggedUserInfo) {\r\n    const loggedUserInfoDto: LoggedUserInfoDTO = JSON.parse(loggedUserInfo);\r\n    return loggedUserInfoDto;\r\n  }\r\n  return undefined;\r\n};\r\n\r\nexport const resetUserInfo = () => {\r\n  localStorage.removeItem(LOGGED_USER_INFO_LOCAL_STORAGE_KEY);\r\n};\r\n\r\nexport const getTripsOfDate = (date: Date, trips: TripDTO[], user: UserDTO | undefined): TripDTO[] => {\r\n  const tripsOfDate: TripDTO[] = trips\r\n    .filter((trip: TripDTO) => {\r\n      return new Date(trip.date).setHours(0, 0, 0, 0) === date.setHours(0, 0, 0, 0);\r\n    })\r\n    .filter((trip: TripDTO) => filterTripsByOccupation(trip, user))\r\n    .sort((trip1: TripDTO, trip2: TripDTO) => {\r\n      const hour1Replaced = trip1.hour.split(':').join('');\r\n      const hour2Replaced = trip2.hour.split(':').join('');\r\n      return Number(hour1Replaced) - Number(hour2Replaced);\r\n    });\r\n  return tripsOfDate;\r\n};\r\n\r\nexport const filterTripsByOccupation = (trip: TripDTO, user: UserDTO | undefined): boolean => {\r\n  if (user !== undefined && user.committeeUser !== undefined) {\r\n    const occupation = user.committeeUser.occupation;\r\n    if (occupation === 0 || occupation === 2) {\r\n      // Se è dipendente o medico, vede tutti i servizi\r\n      return true;\r\n    }\r\n    // Volontario o altro, vede i servizi non destinati ai dipendenti\r\n    return trip.type > 0;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const compareTripUsers = (a: TripUsersDTO, b: TripUsersDTO) => {\r\n  if (a.role === 0) {\r\n    // Prima visualizzo gli autisti\r\n    return -1;\r\n  }\r\n  if (a.role === 2) {\r\n    // Poi do priorità al medico/sanitario\r\n    if (b.role === 0) {\r\n      return 1;\r\n    }\r\n    if (b.role === 1) {\r\n      return -1;\r\n    }\r\n  }\r\n  return 1; // Infine i soccorritori\r\n};\r\n\r\nexport const getRoleBackgroundColor = (role: number): string => {\r\n  if (role === 0) {\r\n    return '#d9d9d9';\r\n  } else if (role === 2) {\r\n    return '#1890ff';\r\n  }\r\n  return '#87d068';\r\n};","import axios, { AxiosInstance } from 'axios';\r\nimport VehicleDTO from '../dto/VehicleDTO';\r\nimport UserDTO from '../dto/UserDTO';\r\nimport CommitteeUserDTO from '../dto/CommitteeUserDTO';\r\nimport TripDTO from '../dto/TripDTO';\r\nimport TripUsersDTO from '../dto/TripUsersDTO';\r\nimport { getUserInfo } from './Utils';\r\nimport LoggedUserInfoDTO from '../dto/LoggedUserInfoDTO';\r\n\r\nexport class Connector {\r\n  private axiosInstance: AxiosInstance;\r\n\r\n  constructor() {\r\n    const headers = {\r\n      'Content-Type': 'application/json'\r\n    };\r\n\r\n    let baseURL: string | undefined = undefined;\r\n    if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n      baseURL = 'http://localhost:3001';\r\n    } else {\r\n      baseURL = window.location.origin;\r\n    }\r\n    this.axiosInstance = axios.create({\r\n      baseURL,\r\n      headers\r\n    });\r\n  }\r\n\r\n  public async getCommittees(): Promise<any> {\r\n    const operation = 'api/committees';\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async getVehicles(committeeId: number): Promise<any> {\r\n    const operation = `api/vehicles/findByCommittee/${committeeId}`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async publishVehicle(vehicle: VehicleDTO): Promise<any> {\r\n    const { id } = vehicle;\r\n    const operation = `api/vehicles/${id > 0 ? id : ''}`;\r\n    const body = JSON.stringify(vehicle);\r\n    return await this.call(operation, body, id > 0 ? 'PUT' : 'POST');\r\n  }\r\n\r\n  public async deleteVehicle(vehicle: VehicleDTO): Promise<any> {\r\n    const { id } = vehicle;\r\n    const operation = `api/vehicles/${id}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async deleteTripUsersByTrip(tripId: number): Promise<any> {\r\n    const operation = `api/trips_users/deleteByTrip/${tripId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async deleteTripUsers(tripUserId: number): Promise<any> {\r\n    const operation = `api/trips_users/${tripUserId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async deleteCommitteesUsers(userId: number): Promise<any> {\r\n    const operation = `api/committees_users/deleteByUserId/${userId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async getUserTrips(userId: number): Promise<any> {\r\n    const operation = `api/trips_users/findByUserId/${userId}`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async deleteTrip(tripId: number): Promise<any> {\r\n    const operation = `api/trips/${tripId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async getTrips(committeeId: number): Promise<any> {\r\n    const operation = `api/trips/findByCommittee/${committeeId}`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async getAvailableTrips(): Promise<any> {\r\n    const operation = `api/trips/available`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async getBookedTrips(): Promise<any> {\r\n    const operation = `api/trips/booked`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async publishTrip(trip: TripDTO): Promise<any> {\r\n    const { id } = trip;\r\n    const operation = `api/trips/${id > 0 ? id : ''}`;\r\n    const body = JSON.stringify(trip);\r\n    return await this.call(operation, body, id > 0 ? 'PUT' : 'POST');\r\n  }\r\n\r\n  public async publishTripUser(tripUser: TripUsersDTO): Promise<any> {\r\n    const { id } = tripUser;\r\n    const operation = `api/trips_users/${id > 0 ? id : ''}`;\r\n    const body = JSON.stringify(tripUser);\r\n    return await this.call(operation, body, id > 0 ? 'PUT' : 'POST');\r\n  }\r\n\r\n  public async getUser(userId: number): Promise<any> {\r\n    const operation = `api/users/${userId}`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async getUsers(committeeId: number): Promise<any> {\r\n    const operation = `api/users/findByCommittee/${committeeId}`;\r\n    return await this.call(operation);\r\n  }\r\n\r\n  public async deleteUser(userId: number): Promise<any> {\r\n    const operation = `api/users/${userId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async deleteCommitteeUser(committeeUserId: number): Promise<any> {\r\n    const operation = `api/committees_users/${committeeUserId}`;\r\n    return await this.call(operation, undefined, 'DELETE');\r\n  }\r\n\r\n  public async modifyPassword(oldPassword: string, newPassword: string): Promise<any> {\r\n    const operation = `api/users/modifypassword`;\r\n    const body = JSON.stringify({\r\n      oldPassword,\r\n      newPassword\r\n    });\r\n    return await this.call(operation, body, 'POST');\r\n  }\r\n\r\n  public async publishUser(user: UserDTO): Promise<any> {\r\n    const { id } = user;\r\n    const operation = `api/users/${id > 0 ? id : ''}`;\r\n    const body = JSON.stringify(user);\r\n    return this.call(operation, body, id > 0 ? 'PUT' : 'POST');\r\n  }\r\n\r\n  public async publishUserCommittee(user: UserDTO, committeeUserInfo: CommitteeUserDTO): Promise<any> {\r\n    const userResponse = await this.publishUser(user);\r\n    if (userResponse.status !== 201 && userResponse.status !== 200) {\r\n      console.log(userResponse);\r\n      throw new Error(`Si è verificato un errore nell'inserimento`);\r\n    }\r\n\r\n    const { id } = user;\r\n    const publishedUser: UserDTO = userResponse.data;\r\n    const committeeUser: CommitteeUserDTO = {\r\n      id: committeeUserInfo.id,\r\n      userId: id > 0 ? id : publishedUser.id,\r\n      committeeId: committeeUserInfo.committeeId,\r\n      role: committeeUserInfo.role,\r\n      occupation: committeeUserInfo.occupation,\r\n      disabled: committeeUserInfo.disabled\r\n    };\r\n    const bodyCommUser = JSON.stringify(committeeUser);\r\n    const operationCommUser = `api/committees_users/${committeeUserInfo.id > 0 ? committeeUserInfo.id : ''}`;\r\n    return await this.call(operationCommUser, bodyCommUser, committeeUserInfo.id > 0 ? 'PUT' : 'POST');\r\n  }\r\n\r\n  public async signin(username: string, password: string, committeeId: number): Promise<any> {\r\n    let baseURL: string | undefined = undefined;\r\n    if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n      baseURL = 'http://localhost:3001';\r\n    }\r\n    const tempInstance = axios.create({\r\n      baseURL\r\n    });\r\n    return tempInstance({\r\n      url: `api/auth/signin`,\r\n      method: 'POST',\r\n      data: {\r\n        username,\r\n        password,\r\n        committeeId\r\n      }\r\n    });\r\n  }\r\n\r\n  public async findUserByUsername(username: string, password: string): Promise<any> {\r\n    const operation = `api/users/findbyusername/${username}`;\r\n    const hash: string = btoa(`${username}:${password}`);\r\n    const headers = {\r\n      Authorization: `Basic ${hash}`\r\n    };\r\n    let baseURL: string | undefined = undefined;\r\n    if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n      baseURL = 'http://localhost:3001';\r\n    }\r\n    const tempInstance = axios.create({\r\n      baseURL,\r\n      headers\r\n    });\r\n    return tempInstance({\r\n      url: operation,\r\n      method: 'GET'\r\n    });\r\n  }\r\n\r\n  private authHeader = () => {\r\n    const userInfo: LoggedUserInfoDTO | undefined = getUserInfo();\r\n    if (userInfo && userInfo.accessToken) {\r\n      // for Node.js Express back-end\r\n      return { 'x-access-token': userInfo.accessToken };\r\n    } else {\r\n      return {};\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @param url\r\n   * @param body stringa (in json) oppure UrlSearchParams per gli environment\r\n   * @param method\r\n   */\r\n  private async call(url: string, body?: string, method: 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE' = 'GET'): Promise<any> {\r\n    return this.axiosInstance({\r\n      url,\r\n      method,\r\n      headers: this.authHeader(),\r\n      data: body\r\n    });\r\n  }\r\n}\r\n","import { combineReducers } from 'redux';\r\nimport { TReducerActions, ReduxActionTypes } from '../actions/action';\r\nimport { Connector } from '../utils/Connector';\r\nimport UserDTO from '../dto/UserDTO';\r\nimport CommitteeDTO from '../dto/CommitteeDTO';\r\nimport { resetUserInfo } from '../utils/Utils';\r\n\r\nexport interface AppDataState extends WithUser, WithCommittee, WithConnector {\r\n  user: UserDTO | undefined;\r\n  accessToken: string;\r\n  committee: CommitteeDTO | undefined;\r\n  users: UserDTO[];\r\n  showLoading: boolean;\r\n  connector: Connector;\r\n}\r\n\r\nconst stateDefault: AppDataState = {\r\n  user: undefined,\r\n  accessToken: '',\r\n  committee: undefined,\r\n  users: [],\r\n  connector: new Connector(),\r\n  showLoading: false\r\n};\r\n\r\nexport interface WithUser {\r\n  user: UserDTO | undefined;\r\n}\r\n\r\nexport interface WithUsers {\r\n  users: UserDTO[];\r\n}\r\n\r\nexport interface WithCommittee {\r\n  committee: CommitteeDTO | undefined;\r\n}\r\n\r\nexport interface WithConnector {\r\n  connector: Connector;\r\n}\r\n\r\nconst appData = (state: AppDataState = stateDefault, action: TReducerActions): AppDataState => {\r\n  switch (action.type) {\r\n    case ReduxActionTypes.SET_ACCESS_TOKEN:\r\n      const { accessToken } = action.data;\r\n      const connector = new Connector();\r\n      return {\r\n        ...state,\r\n        accessToken,\r\n        connector\r\n      };\r\n    case ReduxActionTypes.SET_USER_DATA:\r\n      const { user, committeeId } = action.data;\r\n      let normalizedUser = (user && { ...user }) || undefined;\r\n      if (user) {\r\n        if ((user as any).committee_users) {\r\n          normalizedUser = {\r\n            ...user,\r\n            committeeUser: (user as any).committee_users.find((committee_user: any) => committee_user.committeeId === committeeId)\r\n          };\r\n        }\r\n      }\r\n      const newState = {\r\n        ...state,\r\n        user: normalizedUser\r\n      };\r\n      return newState;\r\n    case ReduxActionTypes.SET_COMMITTEE_DATA:\r\n      const { committee } = action.data;\r\n      return {\r\n        ...state,\r\n        committee\r\n      };\r\n    case ReduxActionTypes.SET_SHOW_LOADING:\r\n      return { ...state, showLoading: action.data };\r\n    case ReduxActionTypes.RESET_AUTH_DATA:\r\n      resetUserInfo();\r\n      return {\r\n        ...state,\r\n        user: undefined,\r\n        committee: undefined,\r\n        connector: new Connector(),\r\n        accessToken: '',\r\n        users: []\r\n      };\r\n    case ReduxActionTypes.SET_USERS_DATA:\r\n      const { users } = action.data;\r\n      const normalizedUsers: any = (users || []).map((userToNormalize: UserDTO) => {\r\n        return {\r\n          ...userToNormalize,\r\n          committeeUser: (userToNormalize as any).committee_users[0]\r\n        };\r\n      });\r\n      return {\r\n        ...state,\r\n        users: normalizedUsers\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst AppReducers = combineReducers({\r\n  appData\r\n});\r\n\r\nexport default AppReducers;\r\n","export const Links = {\r\n  LOGIN: '/',\r\n  DESKTOP: '/desktop',\r\n  DESKTOP_SERVICES: '/desktop/services',\r\n  DESKTOP_USERS: '/desktop/users',\r\n  DESKTOP_VEHICLES: '/desktop/vehicles',\r\n  DESKTOP_PERSONAL_AREA: '/desktop/personal_area',\r\n  MOBILE_LOGIN: '/mobile',\r\n  MOBILE_SERVICES: '/mobile/services',\r\n  MOBILE_BOOKED_SERVICES: '/mobile/booked_services',\r\n  MOBILE_PERSONAL_AREA: '/mobile/personal_area'\r\n};\r\n","import * as React from 'react';\r\nimport { Button, Col, Form, message, Modal, Row, Input, Select, Icon } from 'antd';\r\nimport { connect } from 'react-redux';\r\nimport { WithUser, WithConnector } from '../../reducers/reducers';\r\nimport {\r\n  setUserData,\r\n  setAccessToken,\r\n  setCommitteeData,\r\n  setUsersData,\r\n  SetUserDataProps,\r\n  SetCommitteeDataProps,\r\n  SetUsersDataProps,\r\n  SetAccessTokenProps\r\n} from '../../actions/action';\r\nimport { Connector } from '../../utils/Connector';\r\nimport CommitteeDTO from '../../dto/CommitteeDTO';\r\nimport { FormComponentProps } from 'antd/lib/form/Form';\r\nimport { Links } from '../../utils/Links';\r\nimport { RouterProps, RouteProps } from 'react-router';\r\nimport { PORTAL_NAME } from '../../utils/Constants';\r\nimport { getUserInfo, setUserInfo } from '../../utils/Utils';\r\n\r\nconst { Option } = Select;\r\n\r\ninterface LoginFormState {\r\n  committees: CommitteeDTO[];\r\n  isForMobile: boolean;\r\n  loading: boolean;\r\n}\r\n\r\ninterface LoginFormProps\r\n  extends WithUser,\r\n    WithConnector,\r\n    SetUserDataProps,\r\n    SetAccessTokenProps,\r\n    SetCommitteeDataProps,\r\n    SetUsersDataProps,\r\n    FormComponentProps,\r\n    RouterProps,\r\n    RouteProps {}\r\n\r\nclass LoginForm extends React.Component<LoginFormProps, LoginFormState> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    let isForMobile = false;\r\n    const { location } = this.props;\r\n    if (location !== undefined) {\r\n      const { pathname } = location;\r\n      isForMobile = pathname === Links.MOBILE_LOGIN;\r\n      this.state = {\r\n        committees: [],\r\n        isForMobile,\r\n        loading: false\r\n      };\r\n    }\r\n  }\r\n\r\n  connector: Connector | undefined;\r\n\r\n  componentDidMount() {\r\n    const userInfo = getUserInfo();\r\n    if (userInfo) {\r\n      this.login(userInfo.id, userInfo.committeeId);\r\n    }\r\n    this.props.connector\r\n      .getCommittees()\r\n      .then((res) => {\r\n        this.setState(\r\n          {\r\n            ...this.state,\r\n            committees: res.data\r\n          },\r\n          () => {\r\n            if (res.data && res.data[0]) {\r\n              this.handleSelectChange(res.data[0].id);\r\n              if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n                this.props.form.setFieldsValue({\r\n                  username: 'f.marchetti',\r\n                  password: 'default'\r\n                });\r\n              }\r\n            }\r\n          }\r\n        );\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  handleSelectChange = (value: number) => {\r\n    this.props.form.setFieldsValue({\r\n      committeeId: value\r\n    });\r\n  };\r\n\r\n  private buildCommitteesSelect = () => {\r\n    const { committees } = this.state;\r\n    if (committees.length === 0) {\r\n      return <Icon type=\"loading\" />;\r\n    }\r\n\r\n    const { getFieldDecorator } = this.props.form;\r\n    return (\r\n      <Form.Item>\r\n        {getFieldDecorator('committeeId', {\r\n          rules: [{ required: true, message: 'Selezionare il comitato' }]\r\n        })(\r\n          <Select onChange={this.handleSelectChange}>\r\n            {committees.map((committee: CommitteeDTO) => (\r\n              <Option key={committee.id} value={committee.id}>\r\n                {committee.description}\r\n              </Option>\r\n            ))}\r\n          </Select>\r\n        )}\r\n      </Form.Item>\r\n    );\r\n  };\r\n\r\n  private login = (userId: number, committeeId: number) => {\r\n    const { connector } = this.props;\r\n    const { isForMobile } = this.state;\r\n    connector\r\n      .getUser(userId)\r\n      .then((res) => {\r\n        const user = res.data;\r\n        const committee_users: Array<any> = user.committee_users;\r\n        if (committee_users) {\r\n          const founded = committee_users.find((element) => element.committeeId === committeeId);\r\n          if (!founded || founded.disabled === 1) {\r\n            message.error('Utente non abilitato al comitato selezionato');\r\n          } else {\r\n            this.props.setUserData(user, committeeId);\r\n            this.props.setCommitteeData(founded.committee);\r\n            this.props.connector\r\n              .getUsers(committeeId)\r\n              .then((uRes) => {\r\n                message.success(`Benvenuto ${user.username}`);\r\n                this.props.setUsersData(uRes.data);\r\n                this.props.history.replace(isForMobile ? Links.MOBILE_SERVICES : Links.DESKTOP_SERVICES);\r\n              })\r\n              .catch((uErr) => {\r\n                message.error(`Si è verificato un errore nel recupero degli utenti`);\r\n              });\r\n          }\r\n        } else {\r\n          message.error('Utente non abilitato al comitato selezionato');\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        message.error(`Si è verificato un errore. Contattare l'amministratore di sistema.`);\r\n      });\r\n  };\r\n\r\n  private handleSubmit = (e: any) => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        this.setState({ loading: true }, () => {\r\n          const committeeId = values.committeeId;\r\n          const { username, password } = values;\r\n          this.props.connector\r\n            .signin(username, password, committeeId)\r\n            .then((res) => {\r\n              const { id, committeeId } = res.data;\r\n              setUserInfo(res.data);\r\n              this.setState({ loading: false }, () => this.login(id, committeeId));\r\n            })\r\n            .catch((err) => {\r\n              let errorMessage = 'Username e password non validi';\r\n              const { response } = err;\r\n              if (response) {\r\n                const { data } = response;\r\n                if (data) {\r\n                  errorMessage = data.message;\r\n                }\r\n              }\r\n              this.setState({ loading: false }, () => message.error(errorMessage));\r\n              console.error(err);\r\n            });\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { committees, isForMobile } = this.state;\r\n    return (\r\n      <Modal visible={true} closable={false} confirmLoading={false} footer={null}>\r\n        <div style={{ textAlign: 'right' }}>\r\n          <b>{PORTAL_NAME}</b>\r\n          {isForMobile ? <Icon type=\"mobile\" /> : undefined}\r\n        </div>\r\n        <Row gutter={8}>\r\n          <Col span={24}>\r\n            <img alt={''} src={process.env.PUBLIC_URL + '/red_cross_logo.png'} width=\"100%\" />\r\n          </Col>\r\n        </Row>\r\n        <Form onSubmit={this.handleSubmit} className=\"login-form\">\r\n          <Form.Item>\r\n            {getFieldDecorator('username', {\r\n              rules: [{ required: true, message: 'Username obbligatoria' }]\r\n            })(<Input prefix={<Icon type=\"user\" style={{ color: 'rgba(0,0,0,.25)' }} />} placeholder=\"Digitare il proprio username\" />)}\r\n          </Form.Item>\r\n          <Form.Item>\r\n            {getFieldDecorator('password', {\r\n              rules: [{ required: true, message: 'Password obbligatoria' }]\r\n            })(<Input prefix={<Icon type=\"lock\" style={{ color: 'rgba(0,0,0,.25)' }} />} type=\"password\" placeholder=\"Digitare la propria password\" />)}\r\n          </Form.Item>\r\n          {this.buildCommitteesSelect()}\r\n          <Form.Item>\r\n            <Button\r\n              loading={this.state.loading}\r\n              disabled={committees === null || committees === undefined || committees.length === 0}\r\n              type=\"primary\"\r\n              htmlType=\"submit\"\r\n              style={{ width: '100%' }}\r\n              className=\"login-form-button\"\r\n            >\r\n              Log in\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nconst WrappeLoginForm = Form.create({ name: 'normal_login' })(LoginForm);\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    connector: state.appData.connector\r\n  };\r\n};\r\nconst LoginContainer = connect(mapStateToProps, {\r\n  setUserData,\r\n  setAccessToken,\r\n  setCommitteeData,\r\n  setUsersData\r\n})(WrappeLoginForm);\r\nexport default LoginContainer;\r\n","import * as React from 'react';\r\nimport { Fab } from 'react-tiny-fab';\r\n\r\nexport interface PlusFabButtonProps {\r\n  onClick: () => void;\r\n}\r\n\r\nclass PlusFabButton extends React.Component<PlusFabButtonProps, any> {\r\n  public render() {\r\n    return (\r\n      <Fab\r\n        mainButtonStyles={{ backgroundColor: '#1890ff' }}\r\n        alwaysShowTitle={false}\r\n        event={'click'}\r\n        icon={<span>+</span>}\r\n        position={{ bottom: 5, right: 5 }}\r\n        onClick={this.props.onClick}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default PlusFabButton;\r\n","import CommitteeDTO from './CommitteeDTO';\r\nimport VehicleDTO from './VehicleDTO';\r\nimport TripUsersDTO from './TripUsersDTO';\r\n\r\nexport default interface TripDTO {\r\n  id: number;\r\n  date: string;\r\n  hour: string; // Esiste il time?\r\n  flgDestination: number;\r\n  flgAr: number;\r\n  siteDeparture: string;\r\n  siteArrival: string;\r\n  serviceType: string;\r\n  patientData?: string;\r\n  type: number;\r\n  extraUsers: number;\r\n  flgNurse: number;\r\n  flgToNotify: number;\r\n  notes?: string;\r\n  committeeId: number;\r\n  vehicleId?: number;\r\n  committee: CommitteeDTO;\r\n  vehicle?: VehicleDTO;\r\n  trip_users?: TripUsersDTO[];\r\n}\r\n\r\nexport const ServiceTargetRoleType: { [code: number]: string } = {\r\n  0: 'Solo Dipendenti',\r\n  1: 'Dipendenti e Volontari'\r\n};\r\n\r\nexport const ServiceTargetLocationType: { [code: number]: string } = {\r\n  0: 'In Sede',\r\n  1: 'Destinazione',\r\n  2: 'Prelevamento'\r\n};\r\n\r\nexport const FlgArType: { [code: number]: string } = {\r\n  0: 'Solo Andata',\r\n  1: 'Andata/Ritorno'\r\n};\r\n","import CommitteeDTO from './CommitteeDTO';\r\n\r\nexport default interface VehicleDTO {\r\n  id: number;\r\n  type: number;\r\n  plate: string;\r\n  sign: string;\r\n  description: string;\r\n  disabled: number;\r\n  committeeId: number;\r\n  committee: CommitteeDTO;\r\n}\r\n\r\nexport const VehicleType: { [code: number]: string } = {\r\n  0: 'Furgone',\r\n  1: 'Ambulanza',\r\n  2: 'Autovettura'\r\n};\r\n","import * as React from 'react';\r\nimport { Drawer, Form, Col, Row, Input, InputNumber, DatePicker, TimePicker, Button, Radio, Select, Switch } from 'antd';\r\nimport { FormComponentProps } from 'antd/lib/form/Form';\r\nimport TripDTO, { ServiceTargetLocationType, FlgArType, ServiceTargetRoleType } from '../../../dto/TripDTO';\r\nimport moment from 'moment';\r\nimport VehicleDTO, { VehicleType } from '../../../dto/VehicleDTO';\r\n\r\nconst { Option } = Select;\r\n\r\nexport interface TripFormProps {\r\n  visible: boolean;\r\n  vehicles: VehicleDTO[];\r\n  trip: TripDTO | undefined;\r\n  onClose: () => void;\r\n  onSave: (trip: TripDTO) => void;\r\n}\r\n\r\nclass Trip extends React.Component<TripFormProps & FormComponentProps> {\r\n  private setFieldsValue = (trip: TripDTO) => {\r\n    const { form } = this.props;\r\n    const dateForHour = new Date(2000, 1, 1, trip.hour ? Number(trip.hour.substring(0, 2)) : 12, trip.hour ? Number(trip.hour.substring(3, 5)) : 0);\r\n    const formValues = {\r\n      ...trip,\r\n      tripDate: trip.date ? moment(trip.date) : undefined,\r\n      tripHour: moment(dateForHour)\r\n    };\r\n    form.setFieldsValue(formValues);\r\n  };\r\n\r\n  componentWillReceiveProps(nextProps: TripFormProps & FormComponentProps) {\r\n    const { trip } = nextProps;\r\n    if (trip !== undefined && JSON.stringify(this.props.trip) !== JSON.stringify(nextProps.trip)) {\r\n      this.setFieldsValue(trip as TripDTO);\r\n    }\r\n  }\r\n\r\n  private handleSubmit = (e: any) => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        const { vehicleId } = values;\r\n        const tripToSave: TripDTO = {\r\n          ...values,\r\n          vehicleId: vehicleId === undefined ? null : vehicleId,\r\n          date: values.tripDate ? values.tripDate.format('YYYY-MM-DD') : undefined,\r\n          hour: values.tripHour.format('HH:mm')\r\n        };\r\n        this.props.onSave(tripToSave);\r\n      }\r\n    });\r\n  };\r\n\r\n  private buildVehicleOptions = () => {\r\n    const { vehicles } = this.props;\r\n    const actualVehicles = vehicles.map((vehicle: VehicleDTO) => {\r\n      const vehicleId: number = vehicle.id;\r\n      return (\r\n        <Option key={vehicleId} value={vehicle.id}>\r\n          {vehicle.sign} - {VehicleType[vehicle.type]}\r\n        </Option>\r\n      );\r\n    });\r\n    const nullOptionVehicle = (\r\n      <Option key={-1} value={undefined}>\r\n        <div>&nbsp;</div>\r\n      </Option>\r\n    );\r\n    return [nullOptionVehicle, ...actualVehicles];\r\n  };\r\n\r\n  public render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { trip, onClose, visible } = this.props;\r\n    return (\r\n      <Drawer title={`${trip?.id === 0 ? 'Crea' : 'Modifica'} servizio`} width={480} onClose={onClose} visible={visible} bodyStyle={{ paddingBottom: 80 }}>\r\n        <Form layout=\"vertical\" onSubmit={this.handleSubmit}>\r\n          <Row gutter={16}>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Data del servizio\">\r\n                {getFieldDecorator('tripDate', {\r\n                  rules: [{ required: true, message: 'Specificare data di partenza' }]\r\n                })(<DatePicker style={{ width: '100%' }} format=\"DD-MM-YYYY\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Ora\">\r\n                {getFieldDecorator('tripHour', {\r\n                  rules: [\r\n                    {\r\n                      type: 'object',\r\n                      required: true,\r\n                      message: `Specificare l'ora del servizio`\r\n                    }\r\n                  ]\r\n                })(<TimePicker style={{ width: '100%' }} placeholder=\"Ora servizio\" format=\"HH:mm\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Luogo\">\r\n                {getFieldDecorator('flgDestination', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il luogo'\r\n                    }\r\n                  ]\r\n                })(\r\n                  <Select placeholder=\"Luogo\">\r\n                    <Option value={0}>{ServiceTargetLocationType[0]}</Option>\r\n                    <Option value={1}>{ServiceTargetLocationType[1]}</Option>\r\n                    <Option value={2}>{ServiceTargetLocationType[2]}</Option>\r\n                  </Select>\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item label=\"Partenza\">\r\n                {getFieldDecorator('siteDeparture', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il luogo di partenza'\r\n                    }\r\n                  ]\r\n                })(<Input.TextArea rows={4} placeholder=\"Luogo di partenza\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item label=\"Arrivo\">\r\n                {getFieldDecorator('siteArrival', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il luogo di arrivo'\r\n                    }\r\n                  ]\r\n                })(<Input.TextArea rows={4} placeholder=\"Luogo di arrivo\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Veicolo\">{getFieldDecorator('vehicleId')(<Select>{this.buildVehicleOptions()}</Select>)}</Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item>\r\n                {getFieldDecorator('flgAr')(\r\n                  <Radio.Group style={{ marginTop: '10px' }}>\r\n                    <Radio value={0}>{FlgArType[0]}</Radio>\r\n                    <Radio value={1}>{FlgArType[1]}</Radio>\r\n                  </Radio.Group>\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Servizio per\">\r\n                {getFieldDecorator('type', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il tipo'\r\n                    }\r\n                  ]\r\n                })(\r\n                  <Select placeholder=\"Servizio per\">\r\n                    <Option value={0}>{ServiceTargetRoleType[0]}</Option>\r\n                    <Option value={1}>{ServiceTargetRoleType[1]}</Option>\r\n                  </Select>\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Tipologia servizio\">\r\n                {getFieldDecorator('serviceType', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il tipo di servizio'\r\n                    }\r\n                  ]\r\n                })(<Input.TextArea rows={2} placeholder=\"Tipologia servizio\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Dati paziente\">{getFieldDecorator('patientData')(<Input.TextArea rows={2} placeholder=\"Dati paziente\" />)}</Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Medico/sanitario\">{getFieldDecorator('flgNurse', { valuePropName: 'checked' })(<Switch />)}</Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Note\">{getFieldDecorator('notes')(<Input.TextArea rows={3} placeholder=\"Eventuali note aggiuntive\" />)}</Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Numero accompagnatori\">{getFieldDecorator('extraUsers', { initialValue: 1 })(<InputNumber min={0} max={10} />)}</Form.Item>\r\n            </Col>\r\n            <Col span={8}>\r\n              <Form.Item label=\"Da notificare\">{getFieldDecorator('flgToNotify', { valuePropName: 'checked' })(<Switch />)}</Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16} style={{ visibility: 'collapse' }}>\r\n            <Col span={6}>\r\n              <Form.Item label=\"Id\">{getFieldDecorator('id')(<Input placeholder=\"Specificare id servizio\" />)}</Form.Item>\r\n              <Col span={6}>\r\n                <Form.Item label=\"CommitteeId\">{getFieldDecorator('committeeId')(<Input placeholder=\"CommitteeId\" />)}</Form.Item>\r\n              </Col>\r\n            </Col>\r\n          </Row>\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              right: 0,\r\n              bottom: 0,\r\n              width: '100%',\r\n              borderTop: '1px solid #e9e9e9',\r\n              padding: '10px 16px',\r\n              background: '#fff',\r\n              textAlign: 'right'\r\n            }}\r\n          >\r\n            <Button onClick={this.props.onClose} style={{ marginRight: 8 }}>\r\n              Annulla\r\n            </Button>\r\n            <Button htmlType=\"submit\" type=\"primary\">\r\n              Salva\r\n            </Button>\r\n          </div>\r\n        </Form>\r\n      </Drawer>\r\n    );\r\n  }\r\n}\r\n\r\nconst TripContainer = Form.create({ name: 'trip_form ' })(Trip);\r\nclass TripForm extends React.Component<TripFormProps> {\r\n  public render() {\r\n    return <TripContainer {...this.props} />;\r\n  }\r\n}\r\n\r\nexport default TripForm;\r\n","import * as React from 'react';\r\nimport TripDTO from '../../../dto/TripDTO';\r\nimport Form, { FormComponentProps } from 'antd/lib/form/Form';\r\nimport { Icon, Button, Drawer, Row, Col, DatePicker, TimePicker } from 'antd';\r\nimport moment from 'moment';\r\n\r\nexport interface IDuplicateTripItem {\r\n  date: moment.Moment;\r\n  hour: moment.Moment;\r\n}\r\n\r\nexport interface IDuplicateTripFormProps {\r\n  visible: boolean;\r\n  trip: TripDTO | undefined;\r\n  onClose: () => void;\r\n  onConfirm: (trip: TripDTO, newDates: IDuplicateTripItem[]) => void;\r\n}\r\n\r\nlet id = 0;\r\n\r\nclass DuplicateTrip extends React.Component<\r\n  IDuplicateTripFormProps & FormComponentProps\r\n> {\r\n  componentWillReceiveProps(\r\n    nextProps: IDuplicateTripFormProps & FormComponentProps\r\n  ) {\r\n    const { trip } = nextProps;\r\n    if (\r\n      trip !== undefined &&\r\n      JSON.stringify(this.props.trip) !== JSON.stringify(nextProps.trip)\r\n    ) {\r\n      this.props.form.setFieldsValue({\r\n        keys: [],\r\n        duplicateElements: []\r\n      });\r\n    }\r\n  }\r\n\r\n  private onDeleteDate = (k: any) => {\r\n    const { form } = this.props;\r\n    const keys = form.getFieldValue('keys');\r\n    const duplicateElements: IDuplicateTripItem[] =\r\n      form.getFieldValue('duplicateElements') || [];\r\n    if (keys.length === 1) {\r\n      return;\r\n    }\r\n\r\n    form.setFieldsValue({\r\n      keys: keys.filter((key: any) => key !== k),\r\n      duplicateElements: duplicateElements.filter(\r\n        (value: IDuplicateTripItem, index: number) => index !== k\r\n      )\r\n    });\r\n  };\r\n\r\n  private onAddDate = () => {\r\n    const { form } = this.props;\r\n    const keys = form.getFieldValue('keys');\r\n    const nextKeys = keys.concat(id++);\r\n\r\n    form.setFieldsValue({\r\n      keys: nextKeys\r\n    });\r\n  };\r\n\r\n  handleSubmit = (e: any) => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        const { duplicateElements } = values;\r\n        const { trip } = this.props;\r\n        this.props.onConfirm(\r\n          trip as any,\r\n          duplicateElements.filter((element: any) => !!element)\r\n        );\r\n      }\r\n    });\r\n  };\r\n\r\n  private getInitialDateValue = (key: number) => {\r\n    const { trip: tripToDuplicate } = this.props;\r\n    const tripDate = moment(\r\n      tripToDuplicate !== undefined ? tripToDuplicate.date : new Date()\r\n    );\r\n    const newTripDate = tripDate.add(key + 1, 'd');\r\n    return newTripDate;\r\n  };\r\n\r\n  private getInitialHourValue = () => {\r\n    const { trip: tripToDuplicate } = this.props;\r\n    const dateForHour = new Date(\r\n      2000,\r\n      1,\r\n      1,\r\n      tripToDuplicate?.hour ? Number(tripToDuplicate.hour.substring(0, 2)) : 12,\r\n      tripToDuplicate?.hour ? Number(tripToDuplicate.hour.substring(3, 5)) : 0\r\n    );\r\n    const tripHour = moment(dateForHour);\r\n    return tripHour;\r\n  };\r\n\r\n  public render() {\r\n    const { getFieldDecorator, getFieldValue } = this.props.form;\r\n    getFieldDecorator('keys', { initialValue: [] });\r\n    const keys = getFieldValue('keys');\r\n    const myFormItems = keys.map((key: any, index: number) => (\r\n      <Row gutter={16} key={index}>\r\n        <Col span={11}>\r\n          <Form.Item>\r\n            {getFieldDecorator(`duplicateElements[${key}].date`, {\r\n              initialValue: this.getInitialDateValue(index),\r\n              rules: [\r\n                {\r\n                  required: true,\r\n                  message: 'Selezionare data del viaggio'\r\n                }\r\n              ]\r\n            })(<DatePicker style={{ width: '100%' }} format=\"DD-MM-YYYY\" />)}\r\n          </Form.Item>\r\n        </Col>\r\n        <Col span={11}>\r\n          <Form.Item>\r\n            {getFieldDecorator(`duplicateElements[${key}].hour`, {\r\n              initialValue: this.getInitialHourValue(),\r\n              rules: [\r\n                {\r\n                  type: 'object',\r\n                  required: true,\r\n                  message: `Specificare l'ora del servizio`\r\n                }\r\n              ]\r\n            })(\r\n              <TimePicker\r\n                style={{ width: '100%' }}\r\n                placeholder=\"Ora servizio\"\r\n                format=\"HH:mm\"\r\n              />\r\n            )}\r\n          </Form.Item>\r\n        </Col>\r\n        <Col span={2}>\r\n          {key === 0 ? (\r\n            undefined\r\n          ) : (\r\n            <Icon\r\n              style={{ marginTop: '10px' }}\r\n              className=\"dynamic-delete-button\"\r\n              type=\"minus-circle-o\"\r\n              onClick={() => this.onDeleteDate(key)}\r\n            />\r\n          )}\r\n        </Col>\r\n      </Row>\r\n    ));\r\n\r\n    return (\r\n      <Drawer\r\n        title={`Duplica servizio`}\r\n        width={480}\r\n        onClose={this.props.onClose}\r\n        visible={this.props.visible}\r\n        bodyStyle={{ paddingBottom: 80 }}\r\n      >\r\n        <Form onSubmit={this.handleSubmit}>\r\n          {myFormItems}\r\n          <Row gutter={16}>\r\n            <Col span={24}>\r\n              <Form.Item>\r\n                <Button\r\n                  type=\"dashed\"\r\n                  onClick={this.onAddDate}\r\n                  style={{ width: '100%' }}\r\n                >\r\n                  <Icon type=\"plus\" /> Aggiungi data\r\n                </Button>\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              right: 0,\r\n              bottom: 0,\r\n              width: '100%',\r\n              borderTop: '1px solid #e9e9e9',\r\n              padding: '10px 16px',\r\n              background: '#fff',\r\n              textAlign: 'right'\r\n            }}\r\n          >\r\n            <Button onClick={this.props.onClose} style={{ marginRight: 8 }}>\r\n              Annulla\r\n            </Button>\r\n            <Button htmlType=\"submit\" type=\"primary\">\r\n              Conferma\r\n            </Button>\r\n          </div>\r\n        </Form>\r\n      </Drawer>\r\n    );\r\n  }\r\n}\r\n\r\nconst DuplicateTripContainer = Form.create({ name: 'duplicate_trip_form ' })(\r\n  DuplicateTrip\r\n);\r\nclass DuplicateTripForm extends React.Component<IDuplicateTripFormProps> {\r\n  public render() {\r\n    return <DuplicateTripContainer {...this.props} />;\r\n  }\r\n}\r\n\r\nexport default DuplicateTripForm;\r\n","import * as React from 'react';\r\nimport { Months, WeekDays } from '../../../utils/Constants';\r\nimport { Row, Col, Card, Badge } from 'antd';\r\n\r\nexport interface DayOfWeekProps {\r\n  selectedDate: Date;\r\n  date: Date;\r\n  todayTrips: number;\r\n  onClickDayOfWeek: (date: Date) => void;\r\n}\r\n\r\nconst today = new Date();\r\n\r\nclass DayOfWeek extends React.Component<DayOfWeekProps, any> {\r\n  private renderCardHeaderDate(date: Date) {\r\n    const dayOfMonth: number = date.getDate();\r\n    const month: string = Months[date.getMonth()];\r\n    return (\r\n      <Row>\r\n        <Col style={{ textAlign: 'left' }} span={24}>\r\n          {dayOfMonth} {month.substring(0, 3)}\r\n        </Col>\r\n      </Row>\r\n    );\r\n  }\r\n\r\n  private renderCardBodyWeekDay(date: Date) {\r\n    const { todayTrips } = this.props;\r\n    const weekDay: string = WeekDays[date.getDay()];\r\n    return (\r\n      <Row>\r\n        <Col style={{ textAlign: 'left' }} span={24}>\r\n          <b>{weekDay}</b>\r\n          {todayTrips !== 0 ? <Badge count={todayTrips} style={{ backgroundColor: '#87D068', marginLeft: '3px' }} /> : undefined}\r\n        </Col>\r\n      </Row>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    const { selectedDate, date, onClickDayOfWeek } = this.props;\r\n    const isSelected =\r\n      date.getDate() === selectedDate.getDate() && date.getMonth() === selectedDate.getMonth() && date.getFullYear() === selectedDate.getFullYear();\r\n    const isOld = date.getTime() < today.getTime();\r\n    const isToday = date.getTime() === today.getTime();\r\n    return (\r\n      <Card\r\n        onClick={() => onClickDayOfWeek(date)}\r\n        size=\"small\"\r\n        title={this.renderCardHeaderDate(date)}\r\n        className=\"current-day\"\r\n        style={{\r\n          cursor: 'pointer',\r\n          borderRadius: '10px',\r\n          height: '90px',\r\n          border: `2px solid ${isSelected ? '#1890ff' : '#e8e8e8'}`,\r\n          backgroundColor: `${isToday ? '#e6f7ff' : isOld ? '#f2f4f5' : 'white'}`\r\n        }}\r\n      >\r\n        {this.renderCardBodyWeekDay(date)}\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DayOfWeek;\r\n","import * as React from 'react';\r\nimport DayOfWeek from './DayOfWeek';\r\nimport { add } from 'date-fns';\r\nimport UserDTO from '../../../dto/UserDTO';\r\nimport TripDTO from '../../../dto/TripDTO';\r\nimport { getTripsOfDate } from '../../../utils/Utils';\r\nimport { Row, Col } from 'antd';\r\n\r\nexport interface DaysOfWeekProps {\r\n  startDate: Date;\r\n  rowIndex: number;\r\n  selectedDate: Date;\r\n  trips: TripDTO[];\r\n  user: UserDTO | undefined;\r\n  onClickDayOfWeek: (date: Date) => void;\r\n}\r\n\r\nclass DaysOfWeek extends React.Component<DaysOfWeekProps, any> {\r\n  private renderDaysOfWeek = () => {\r\n    const { startDate, rowIndex, selectedDate, trips, user, onClickDayOfWeek } = this.props;\r\n    const elements: any = [];\r\n    for (let index = 0; index < 7; index++) {\r\n      const uniqueIndex = index + rowIndex * 7;\r\n      var actualDate = add(startDate, {\r\n        days: uniqueIndex\r\n      });\r\n      const tripsOfDate = getTripsOfDate(actualDate, trips, user);\r\n      elements.push(\r\n        <Col span={3} key={uniqueIndex}>\r\n          <DayOfWeek date={actualDate} selectedDate={selectedDate} onClickDayOfWeek={onClickDayOfWeek} todayTrips={tripsOfDate.length} />\r\n        </Col>\r\n      );\r\n    }\r\n    return elements;\r\n  };\r\n\r\n  public render() {\r\n    return (\r\n      <Row justify=\"center\" type=\"flex\">\r\n        {this.renderDaysOfWeek()}\r\n      </Row>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DaysOfWeek;\r\n","import * as React from 'react';\r\nimport { ViewModeType } from '../../../utils/Constants';\r\nimport { Row, Button, Col } from 'antd';\r\nimport DaysOfWeek from './DaysOfWeek';\r\nimport TripDTO from '../../../dto/TripDTO';\r\nimport UserDTO from '../../../dto/UserDTO';\r\n\r\nexport interface ServiceCalendarProps {\r\n  viewMode: ViewModeType;\r\n  firstDayOfView: Date;\r\n  selectedDate: Date;\r\n  trips: TripDTO[];\r\n  user: UserDTO | undefined;\r\n  onMoveViewRight: () => void;\r\n  onMoveViewLeft: () => void;\r\n  onClickDayOfWeek: (date: Date) => void;\r\n}\r\n\r\nclass ServiceCalendar extends React.Component<ServiceCalendarProps, any> {\r\n  private renderDays = () => {\r\n    const { viewMode, firstDayOfView, selectedDate, trips, user, onMoveViewLeft, onMoveViewRight, onClickDayOfWeek } = this.props;\r\n    const numRows: number = viewMode === ViewModeType.week ? 1 : 4;\r\n    const rows = [];\r\n    for (let rowIndex = 0; rowIndex < numRows; rowIndex++) {\r\n      const row = (\r\n        <Row justify=\"center\" key={rowIndex} type=\"flex\">\r\n          <Col span={1} style={{ textAlign: 'right' }}>\r\n            {rowIndex === 0 ? <Button icon=\"left\" style={{ margin: 5 }} onClick={onMoveViewLeft} /> : undefined}\r\n          </Col>\r\n          <Col span={22}>\r\n            <DaysOfWeek\r\n              startDate={firstDayOfView}\r\n              rowIndex={rowIndex}\r\n              selectedDate={selectedDate}\r\n              trips={trips}\r\n              user={user}\r\n              onClickDayOfWeek={onClickDayOfWeek}\r\n            />\r\n          </Col>\r\n          <Col span={1} style={{ textAlign: 'left' }}>\r\n            {rowIndex === 0 ? <Button icon=\"right\" style={{ margin: 5 }} onClick={onMoveViewRight} /> : undefined}\r\n          </Col>\r\n        </Row>\r\n      );\r\n      rows.push(row);\r\n    }\r\n\r\n    return rows;\r\n  };\r\n\r\n  public render() {\r\n    return <div>{this.renderDays()}</div>;\r\n  }\r\n}\r\n\r\nexport default ServiceCalendar;\r\n","import * as React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { ViewModeType } from '../../../utils/Constants';\r\n\r\nexport interface ServiceViewModeProps {\r\n  actualValue: ViewModeType;\r\n  onChangeView: (viewMode: ViewModeType) => void;\r\n}\r\n\r\nclass ServiceViewMode extends React.Component<ServiceViewModeProps> {\r\n  public render() {\r\n    const { actualValue, onChangeView } = this.props;\r\n    return (\r\n      <div style={{ textAlign: 'end', margin: 10 }}>\r\n        Visualizzazione:\r\n        <Radio.Group defaultValue={actualValue} size=\"default\" onChange={(e: any) => onChangeView(e.target.value)} style={{ marginLeft: 5 }}>\r\n          <Radio.Button value={ViewModeType.week}>Settimana</Radio.Button>\r\n          <Radio.Button value={ViewModeType.month}>Mese</Radio.Button>\r\n        </Radio.Group>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ServiceViewMode;\r\n","import UserDTO from './UserDTO';\r\n\r\nexport default interface TripUsersDTO {\r\n  id: number;\r\n  tripId: number;\r\n  userId: number;\r\n  role: number;\r\n  user?: UserDTO;\r\n}\r\n\r\nexport const ServiceRoleType: { [code: number]: string } = {\r\n  0: 'Autista',\r\n  1: 'Soccorritore',\r\n  2: 'Medico/Sanitario'\r\n};\r\n","import * as React from 'react';\r\nimport TripUsersDTO, { ServiceRoleType } from '../../../dto/TripUsersDTO';\r\nimport { Button, Radio, Row, Select } from 'antd';\r\nimport { RadioChangeEvent } from 'antd/lib/radio';\r\nimport UserDTO from '../../../dto/UserDTO';\r\n\r\nconst { Option } = Select;\r\n\r\ninterface RoleChooseProps {\r\n  users: UserDTO[];\r\n  tripUsers: TripUsersDTO[];\r\n  isUserAdmin: boolean;\r\n  loggedUser: UserDTO;\r\n  onConfirmRole: (role: number, userId: number) => void;\r\n}\r\n\r\ninterface RoleChooseState {\r\n  roleSelected: number;\r\n  userSelected?: UserDTO;\r\n}\r\n\r\nclass RoleChoose extends React.Component<RoleChooseProps, RoleChooseState> {\r\n  constructor(props: RoleChooseProps) {\r\n    super(props);\r\n    const users = this.getAvailableUsers();\r\n    const initialUser: UserDTO | undefined = users.length > 0 ? users[0] : undefined;\r\n    this.state = {\r\n      userSelected: initialUser,\r\n      roleSelected: 1\r\n    };\r\n  }\r\n\r\n  private _onChangeRole = (e: RadioChangeEvent) => {\r\n    this.setState({ roleSelected: e.target.value });\r\n  };\r\n\r\n  private _onChangeUser = (value: number) => {\r\n    const { users } = this.props;\r\n    const userSelected: UserDTO | undefined = users.find((user: UserDTO) => user.id === value);\r\n    if (userSelected !== undefined) {\r\n      this.setState({ userSelected, roleSelected: 1 });\r\n    }\r\n  };\r\n\r\n  private getAvailableUsers = (): UserDTO[] => {\r\n    const { users, tripUsers, isUserAdmin, loggedUser } = this.props;\r\n    return users\r\n      .filter((user: UserDTO) => !tripUsers.find((tripUser: TripUsersDTO) => tripUser.userId === user.id))\r\n      .filter((user: UserDTO) => isUserAdmin || user.id === loggedUser.id)\r\n      .filter((user: UserDTO) => user.committeeUser.role > 0); // Escludo i superuser\r\n  };\r\n\r\n  private _onConfirmRole = () => {\r\n    const { roleSelected, userSelected } = this.state;\r\n    if (userSelected !== undefined) {\r\n      this.props.onConfirmRole(roleSelected, userSelected.id);\r\n    }\r\n  };\r\n\r\n  public render() {\r\n    const { userSelected, roleSelected } = this.state;\r\n    const avilabledUsers = this.getAvailableUsers();\r\n    return (\r\n      <div>\r\n        <Row>\r\n          <Radio.Group style={{ marginTop: '5px', width: '100%' }} value={roleSelected} buttonStyle=\"solid\" onChange={this._onChangeRole}>\r\n            {userSelected && userSelected.withDrivingLicense === 1 ? <Radio.Button value={0}>{ServiceRoleType[0]}</Radio.Button> : undefined}\r\n            <Radio.Button value={1}>{ServiceRoleType[1]}</Radio.Button>\r\n            {userSelected && userSelected.committeeUser.occupation === 2 ? <Radio.Button value={2}>{ServiceRoleType[2]}</Radio.Button> : undefined}\r\n          </Radio.Group>\r\n        </Row>\r\n        <Row>\r\n          <Select style={{ width: '100%' }} defaultValue={userSelected !== undefined ? userSelected.id : undefined} onChange={this._onChangeUser}>\r\n            {avilabledUsers.map((user: UserDTO) => (\r\n              <Option value={user.id} key={user.id}>\r\n                {user.name} {user.surname}\r\n              </Option>\r\n            ))}\r\n          </Select>\r\n        </Row>\r\n        <Row>\r\n          <Button style={{ marginTop: '5px', width: '100%' }} type=\"primary\" ghost onClick={this._onConfirmRole}>\r\n            Conferma\r\n          </Button>\r\n        </Row>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RoleChoose;\r\n","import * as React from 'react';\r\nimport { Card, Timeline, Col, Badge, Avatar, Tooltip, Popover, Button, Row, Tag, Popconfirm, Empty } from 'antd';\r\nimport TripUsersDTO, { ServiceRoleType } from '../../../dto/TripUsersDTO';\r\nimport TripDTO, { ServiceTargetLocationType, FlgArType, ServiceTargetRoleType } from '../../../dto/TripDTO';\r\nimport { VehicleType } from '../../../dto/VehicleDTO';\r\nimport UserDTO from '../../../dto/UserDTO';\r\nimport { getTripsOfDate, compareTripUsers, getRoleBackgroundColor } from '../../../utils/Utils';\r\nimport RoleChoose from './RoleChoose';\r\n\r\nexport interface ServiceTimelineProps {\r\n  selectedDate: Date;\r\n  trips: TripDTO[];\r\n  user: UserDTO | undefined;\r\n  committeeUsers: UserDTO[];\r\n  rolesVisible: Array<boolean>;\r\n  onEditTrip: (trip: TripDTO) => void;\r\n  onDuplicateTrip: (trip: TripDTO) => void;\r\n  onDeleteTrip: (trip: TripDTO) => void;\r\n  onConfirmRole: (role: number, trip: TripDTO, userId: number) => void;\r\n  onDeleteTripUser: (tripUser: TripUsersDTO) => void;\r\n  onRoleVisibleChange: (uniqueIndex: number, roleVisible: boolean) => void;\r\n}\r\n\r\nclass ServiceTimeline extends React.Component<ServiceTimelineProps> {\r\n  get isUserAdmin(): boolean {\r\n    const { user } = this.props;\r\n    if (user !== undefined && user.committeeUser !== undefined) {\r\n      return user?.committeeUser.role < 2;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private renderTooltipUserAvatar = (trip_user: TripUsersDTO) => {\r\n    const { user, onDeleteTripUser } = this.props;\r\n    const role: string = ServiceRoleType[trip_user.role];\r\n    return (\r\n      <p>\r\n        {role}\r\n        {this.isUserAdmin || (user?.id || 0) === trip_user.userId ? (\r\n          <Tooltip title=\"Elimina\">\r\n            <Button onClick={() => onDeleteTripUser(trip_user)} style={{ marginLeft: '5px' }} icon=\"delete\" type=\"danger\" />\r\n          </Tooltip>\r\n        ) : undefined}\r\n      </p>\r\n    );\r\n  };\r\n\r\n  private renderRoleChoose = (trip: TripDTO, tripUsers: TripUsersDTO[]) => {\r\n    const { committeeUsers, onConfirmRole } = this.props;\r\n    return (\r\n      <RoleChoose\r\n        users={committeeUsers.filter((user: UserDTO) => !!!user.committeeUser.disabled)}\r\n        tripUsers={tripUsers}\r\n        isUserAdmin={this.isUserAdmin}\r\n        loggedUser={this.props.user as UserDTO}\r\n        onConfirmRole={(role: number, userId: number) => onConfirmRole(role, trip, userId)}\r\n      />\r\n    );\r\n  };\r\n\r\n  private renderTimeline = () => {\r\n    const { selectedDate, trips, user, rolesVisible, onEditTrip, onDuplicateTrip, onDeleteTrip, onRoleVisibleChange } = this.props;\r\n    const todayTrips: TripDTO[] = getTripsOfDate(selectedDate, trips, user);\r\n    if (todayTrips.length === 0) {\r\n      return <Empty />;\r\n    }\r\n    const tripWithMoreUsers: TripDTO = todayTrips.reduce((p: TripDTO, v: TripDTO) => {\r\n      return p.extraUsers > v.extraUsers ? p : v;\r\n    });\r\n    const maximumUsers: number = tripWithMoreUsers.extraUsers + 1;\r\n    const sharedSpan: number = Math.floor(24 / maximumUsers);\r\n    return (\r\n      <Timeline>\r\n        {todayTrips.map((trip: TripDTO, index: number) => {\r\n          const { id, vehicle, extraUsers } = trip;\r\n          const trip_users: TripUsersDTO[] = (trip.trip_users || []).sort(compareTripUsers);\r\n          const totalUsers = extraUsers + 1;\r\n          let users: any[] = [];\r\n          for (let index = 0; index < totalUsers; index++) {\r\n            const trip_user: TripUsersDTO = trip_users[index];\r\n            const uniqueIndex: number = Number(`${id}${index}`);\r\n            const popoverVisible: boolean = rolesVisible[uniqueIndex];\r\n            if (trip_user) {\r\n              const user: UserDTO | undefined = trip_user.user;\r\n              users.push(\r\n                <Col span={sharedSpan} key={index} style={{ textAlign: 'center' }}>\r\n                  <Tooltip title={this.renderTooltipUserAvatar(trip_user)}>\r\n                    <Badge style={{ zIndex: 1 }} count={<b>{ServiceRoleType[trip_user.role].substring(0, 1)}</b>}>\r\n                      <Avatar style={{ backgroundColor: getRoleBackgroundColor(trip_user.role) }} shape=\"square\" icon=\"user\" />\r\n                    </Badge>\r\n                    <p>\r\n                      <span style={{ fontSize: '10px' }}>\r\n                        {user?.name} {user?.surname}\r\n                      </span>\r\n                    </p>\r\n                  </Tooltip>\r\n                </Col>\r\n              );\r\n              continue;\r\n            }\r\n            users.push(\r\n              <Col span={sharedSpan} key={index} style={{ textAlign: 'center' }}>\r\n                <Popover\r\n                  content={this.renderRoleChoose(trip, trip_users)}\r\n                  trigger=\"click\"\r\n                  visible={popoverVisible}\r\n                  onVisibleChange={(visible: boolean) => onRoleVisibleChange(uniqueIndex, visible)}\r\n                >\r\n                  <Button type=\"dashed\" icon=\"user\" />\r\n                </Popover>\r\n              </Col>\r\n            );\r\n          }\r\n          return (\r\n            <Timeline.Item key={index}>\r\n              <Row>\r\n                <Col span={8}>\r\n                  <Row>\r\n                    <b>Ora:</b> {trip.hour.substr(0, 5)}\r\n                    <Tag style={{ marginLeft: '5px' }} color=\"green\">\r\n                      {ServiceTargetLocationType[trip.flgDestination]}\r\n                    </Tag>\r\n                  </Row>\r\n                  <Row>\r\n                    <b>Partenza: </b>\r\n                    {trip.siteDeparture}\r\n                  </Row>\r\n                  <Row>\r\n                    <b>Arrivo: </b> {trip.siteArrival}\r\n                  </Row>\r\n                  <Row>\r\n                    <b>Veicolo: </b> {!!vehicle ? `${VehicleType[vehicle.type]} - ${vehicle.sign} - ${vehicle.description}` : '-'}\r\n                  </Row>\r\n                </Col>\r\n                <Col span={4}>\r\n                  <Row>\r\n                    <Tag>{FlgArType[trip.flgAr]}</Tag>\r\n                  </Row>\r\n                  <Row>\r\n                    <Tag color=\"cyan\">{ServiceTargetRoleType[trip.type]}</Tag>\r\n                  </Row>\r\n                  <Row>{trip.flgNurse === 1 ? <Tag color=\"blue\">Medico/sanitario</Tag> : undefined}</Row>\r\n                </Col>\r\n                <Col span={5}>\r\n                  <Row>\r\n                    <b>Paziente: </b>\r\n                    {trip.patientData || '-'}\r\n                  </Row>\r\n                  <Row>\r\n                    <b>Servizio: </b>\r\n                    {trip.serviceType || '-'}\r\n                  </Row>\r\n                  <Row>{trip.notes}</Row>\r\n                </Col>\r\n                <Col span={this.isUserAdmin ? 5 : 7}>\r\n                  <Row>{users}</Row>\r\n                </Col>\r\n                {this.isUserAdmin ? (\r\n                  <Col\r\n                    span={2}\r\n                    style={{\r\n                      textAlign: 'center',\r\n                      padding: '10px'\r\n                    }}\r\n                  >\r\n                    <Tooltip title=\"Modifica\">\r\n                      <Button size=\"small\" icon=\"edit\" onClick={() => onEditTrip(trip)} />\r\n                    </Tooltip>\r\n                    <Tooltip title=\"Duplica\">\r\n                      <Button icon=\"copy\" size=\"small\" style={{ marginLeft: '1px' }} onClick={() => onDuplicateTrip(trip)} />\r\n                    </Tooltip>\r\n                    <Popconfirm\r\n                      placement=\"topLeft\"\r\n                      title={\"Confermare l'eliminazione del servizio?\"}\r\n                      onConfirm={() => onDeleteTrip(trip)}\r\n                      okText=\"Si\"\r\n                      cancelText=\"No\"\r\n                    >\r\n                      <Button size=\"small\" style={{ marginLeft: '1px' }} icon=\"delete\" type=\"danger\" />\r\n                    </Popconfirm>\r\n                  </Col>\r\n                ) : undefined}\r\n              </Row>\r\n            </Timeline.Item>\r\n          );\r\n        })}\r\n      </Timeline>\r\n    );\r\n  };\r\n\r\n  public render() {\r\n    return <Card style={{ width: '100%', height: '100%', borderRadius: '10px' }}>{this.renderTimeline()}</Card>;\r\n  }\r\n}\r\n\r\nexport default ServiceTimeline;\r\n","import React from 'react';\r\nimport { message } from 'antd';\r\nimport { add, format } from 'date-fns';\r\nimport TripDTO from '../../dto/TripDTO';\r\nimport { connect } from 'react-redux';\r\nimport { WithUser, WithConnector, WithCommittee, WithUsers } from '../../reducers/reducers';\r\nimport VehicleDTO from '../../dto/VehicleDTO';\r\nimport TripUsersDTO from '../../dto/TripUsersDTO';\r\nimport PlusFabButton from './base/PlusFabButton';\r\nimport TripForm from './forms/TripForm';\r\nimport DuplicateTripForm, { IDuplicateTripItem } from './forms/DuplicateTripForm';\r\nimport { ViewModeType } from '../../utils/Constants';\r\nimport ServiceCalendar from './base/ServiceCalendar';\r\nimport ServiceViewMode from './base/ServiceViewMode';\r\nimport ServiceTimeline from './base/ServiceTimeline';\r\n\r\ninterface ServicesState {\r\n  loading: boolean;\r\n  selectedDate: Date;\r\n  firstDayOfView: Date;\r\n  viewMode: ViewModeType;\r\n  trips: TripDTO[];\r\n  vehicles: VehicleDTO[];\r\n  showForm: boolean;\r\n  showDuplicateTripForm: boolean;\r\n  selectedTrip: TripDTO | undefined;\r\n  rolesVisible: Array<boolean>;\r\n}\r\n\r\nconst today = new Date();\r\n\r\nclass Services extends React.Component<WithUser & WithConnector & WithCommittee & WithUsers, ServicesState> {\r\n  state = {\r\n    loading: false,\r\n    selectedDate: today,\r\n    firstDayOfView: today,\r\n    viewMode: ViewModeType.week,\r\n    trips: [],\r\n    vehicles: [],\r\n    showForm: false,\r\n    showDuplicateTripForm: false,\r\n    selectedTrip: undefined,\r\n    rolesVisible: []\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.loadData();\r\n  }\r\n\r\n  private getEmptyTrip = (): TripDTO => {\r\n    const { vehicles } = this.state;\r\n    const emptyTrip: TripDTO = {\r\n      id: 0,\r\n      date: format(this.state.selectedDate, 'yyyy-MM-dd'),\r\n      hour: '12:00:00',\r\n      flgDestination: 0,\r\n      flgAr: 0,\r\n      siteDeparture: '',\r\n      siteArrival: '',\r\n      serviceType: '',\r\n      patientData: undefined,\r\n      type: 1,\r\n      extraUsers: 1,\r\n      flgNurse: 0,\r\n      flgToNotify: 0,\r\n      notes: undefined,\r\n      committeeId: this.props.committee?.id || 0,\r\n      vehicleId: vehicles.length !== 0 ? (vehicles[0] as any).id : 0,\r\n      committee: undefined as any,\r\n      vehicle: undefined as any,\r\n      trip_users: []\r\n    };\r\n    return emptyTrip;\r\n  };\r\n\r\n  private loadData = () => {\r\n    const { committee } = this.props;\r\n    if (committee !== undefined) {\r\n      const committeeId: number = committee.id;\r\n      this.props.connector\r\n        .getTrips(committeeId)\r\n        .then((res) => {\r\n          this.setState({\r\n            trips: res.data\r\n          });\r\n          this.props.connector\r\n            .getVehicles(committeeId)\r\n            .then((vRes) => {\r\n              this.setState({\r\n                vehicles: vRes.data,\r\n                loading: false\r\n              });\r\n            })\r\n            .catch((vErr) => {\r\n              this.setState({ vehicles: [], loading: false });\r\n              console.error(vErr);\r\n            });\r\n        })\r\n        .catch((err) => {\r\n          this.setState({ trips: [], loading: false });\r\n          console.error(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  private _onChangeView = (viewMode: ViewModeType) => {\r\n    this.setState({ viewMode });\r\n  };\r\n\r\n  private _onClickDayOfWeek = (date: Date) => {\r\n    this.setState({ selectedDate: date });\r\n  };\r\n\r\n  private _onDeleteTrip = (trip: TripDTO) => {\r\n    const tripId: number = trip.id;\r\n    this.props.connector\r\n      .deleteTripUsersByTrip(tripId)\r\n      .then((res) => {\r\n        this.props.connector\r\n          .deleteTrip(tripId)\r\n          .then((tRes) => {\r\n            this.loadData();\r\n          })\r\n          .catch((tErr) => {\r\n            console.log(`_onDeleteTrip error: ${tErr}`);\r\n            message.error(`Si è verificato un errore durante l'eliminazione`);\r\n            this.loadData();\r\n          });\r\n      })\r\n      .catch((err) => {\r\n        console.log(`_onDeleteTrip error: ${err}`);\r\n        message.error(`Si è verificato un errore durante l'eliminazione`);\r\n      });\r\n  };\r\n\r\n  private _onEditTrip = (trip: TripDTO) => {\r\n    this.setState({ selectedTrip: trip, showForm: true });\r\n  };\r\n\r\n  private _onDuplicateTrip = (trip: TripDTO) => {\r\n    this.setState({ selectedTrip: trip, showDuplicateTripForm: true });\r\n  };\r\n\r\n  private _onDeleteTripUser = (tripUser: TripUsersDTO) => {\r\n    const tripUserId: number = tripUser.id;\r\n    this.props.connector\r\n      .deleteTripUsers(tripUserId)\r\n      .then((res) => {\r\n        this.loadData();\r\n      })\r\n      .catch((err) => {\r\n        console.error(`_onDeleteTripUser: ${err}`);\r\n        message.error(`Si è verificato un errore nell'eliminazione`);\r\n      });\r\n  };\r\n\r\n  get isUserAdmin(): boolean {\r\n    const { user } = this.props;\r\n    if (user !== undefined && user.committeeUser !== undefined) {\r\n      return user?.committeeUser.role < 2;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private _onConfirmRole = (role: number, trip: TripDTO, userId: number) => {\r\n    const tripToPublish: TripUsersDTO = {\r\n      id: 0,\r\n      tripId: trip.id,\r\n      userId,\r\n      role\r\n    };\r\n    const { rolesVisible } = this.state;\r\n    const newRolesVisible = rolesVisible.map((element: boolean) => false);\r\n    this.props.connector\r\n      .publishTripUser(tripToPublish)\r\n      .then((res) => {\r\n        message.success('Salvataggio completato');\r\n        this.setState({ rolesVisible: newRolesVisible }, () => {\r\n          this.loadData();\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onRoleVisibleChange = (uniqueIndex: number, roleVisible: boolean) => {\r\n    const newArray: Array<boolean> = [...this.state.rolesVisible];\r\n    newArray[uniqueIndex] = roleVisible;\r\n    this.setState({ rolesVisible: newArray });\r\n  };\r\n\r\n  private _onCreate = () => {\r\n    this.setState({ selectedTrip: this.getEmptyTrip(), showForm: true });\r\n  };\r\n\r\n  private _onCloseTripForm = () => {\r\n    this.setState({ showForm: false, selectedTrip: undefined });\r\n  };\r\n\r\n  private _onCloseDuplicateTripForm = () => {\r\n    this.setState({ showDuplicateTripForm: false, selectedTrip: undefined });\r\n  };\r\n\r\n  private _onConfirmDuplicateTrip = async (trip: TripDTO, newDates: IDuplicateTripItem[]) => {\r\n    let withError: boolean = false;\r\n    for (let index = 0; index < newDates.length; index++) {\r\n      const newDate: IDuplicateTripItem = newDates[index];\r\n      const date: string = newDate.date.format('YYYY-MM-DD');\r\n      const hour: string = newDate.hour.format('HH:mm');\r\n      const newTrip: TripDTO = {\r\n        ...trip,\r\n        id: 0,\r\n        date,\r\n        hour\r\n      };\r\n\r\n      await this.props.connector\r\n        .publishTrip(newTrip)\r\n        .then((res) => {\r\n          console.log('_onConfirmDuplicateTrip done');\r\n        })\r\n        // eslint-disable-next-line\r\n        .catch((err) => {\r\n          withError = true;\r\n          console.error(`_onConfirmDuplicateTrip error for trip with date ${date} and hour ${hour}. Error: ${err}`);\r\n        });\r\n    }\r\n    this.setState({ showDuplicateTripForm: false, selectedTrip: undefined }, () => {\r\n      if (withError) {\r\n        message.error(`Si sono verificati degli errori durante l'operazione`);\r\n      } else {\r\n        message.success('Operazione completata con successo');\r\n      }\r\n      this.loadData();\r\n    });\r\n  };\r\n\r\n  private _onSave = (trip: TripDTO) => {\r\n    this.props.connector\r\n      .publishTrip(trip)\r\n      .then((res) => {\r\n        message.success('Salvataggio completato');\r\n        this.setState({ showForm: false, selectedTrip: undefined }, () => {\r\n          this.loadData();\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onMoveViewRight = () => {\r\n    const { viewMode, firstDayOfView } = this.state;\r\n    var newFirstDayOfView = add(firstDayOfView, {\r\n      days: viewMode === ViewModeType.week ? 7 : 28\r\n    });\r\n    this.setState({\r\n      firstDayOfView: newFirstDayOfView,\r\n      selectedDate: newFirstDayOfView\r\n    });\r\n  };\r\n\r\n  private _onMoveViewLeft = () => {\r\n    const { viewMode, firstDayOfView } = this.state;\r\n    var newFirstDayOfView = add(firstDayOfView, {\r\n      days: viewMode === ViewModeType.week ? -7 : -28\r\n    });\r\n    this.setState({\r\n      firstDayOfView: newFirstDayOfView,\r\n      selectedDate: newFirstDayOfView\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { selectedTrip, showForm, showDuplicateTripForm, vehicles, viewMode, firstDayOfView, selectedDate, trips, rolesVisible } = this.state;\r\n    const { user, users } = this.props;\r\n    return (\r\n      <div>\r\n        <ServiceViewMode actualValue={viewMode} onChangeView={this._onChangeView} />\r\n        <ServiceCalendar\r\n          viewMode={viewMode}\r\n          firstDayOfView={firstDayOfView}\r\n          selectedDate={selectedDate}\r\n          trips={trips}\r\n          user={user}\r\n          onMoveViewLeft={this._onMoveViewLeft}\r\n          onMoveViewRight={this._onMoveViewRight}\r\n          onClickDayOfWeek={this._onClickDayOfWeek}\r\n        />\r\n        <ServiceTimeline\r\n          selectedDate={selectedDate}\r\n          trips={trips}\r\n          user={user}\r\n          committeeUsers={users}\r\n          rolesVisible={rolesVisible}\r\n          onEditTrip={this._onEditTrip}\r\n          onDuplicateTrip={this._onDuplicateTrip}\r\n          onDeleteTrip={this._onDeleteTrip}\r\n          onConfirmRole={this._onConfirmRole}\r\n          onDeleteTripUser={this._onDeleteTripUser}\r\n          onRoleVisibleChange={this._onRoleVisibleChange}\r\n        />\r\n        <TripForm\r\n          visible={showForm}\r\n          trip={selectedTrip}\r\n          vehicles={vehicles.filter((vehicle: VehicleDTO) => !!!vehicle.disabled)}\r\n          onClose={this._onCloseTripForm}\r\n          onSave={this._onSave}\r\n        />\r\n        <DuplicateTripForm\r\n          visible={showDuplicateTripForm}\r\n          trip={selectedTrip}\r\n          onClose={this._onCloseDuplicateTripForm}\r\n          onConfirm={this._onConfirmDuplicateTrip}\r\n        />\r\n        {showForm || showDuplicateTripForm || (user && user.committeeUser.role > 1) ? undefined : <PlusFabButton onClick={this._onCreate} />}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    connector: state.appData.connector,\r\n    committee: state.appData.committee,\r\n    users: state.appData.users\r\n  };\r\n};\r\nconst ServicesContainer = connect(mapStateToProps)(Services);\r\nexport default ServicesContainer;\r\n","import CommitteeUserDTO from './CommitteeUserDTO';\r\n\r\nexport default interface UserDTO {\r\n  id: number;\r\n  username: string;\r\n  password: string;\r\n  flgPasswordChanged: number;\r\n  name: string;\r\n  surname: string;\r\n  birth_date?: Date;\r\n  email?: string;\r\n  cellphoneNumber?: string;\r\n  gender: number;\r\n  superuser: number;\r\n  withDrivingLicense: number;\r\n  committeeUser: CommitteeUserDTO;\r\n}\r\n\r\nexport const UserRoleType: { [code: number]: string } = {\r\n  0: 'Superuser',\r\n  1: 'Admin',\r\n  2: 'Utente'\r\n};\r\n\r\nexport const UserOccupationType: { [code: number]: string } = {\r\n  0: 'Dipendente',\r\n  1: 'Volontario',\r\n  2: 'Medico/Sanitario',\r\n  3: 'Altro'\r\n};\r\n\r\nexport const UserGenderType: { [code: number]: string } = {\r\n  0: 'Maschio',\r\n  1: 'Femmina',\r\n};\r\n","import * as React from 'react';\r\nimport { Form, Button, Input, Select, DatePicker, Switch, Row, Col } from 'antd';\r\nimport { FormComponentProps } from 'antd/lib/form/Form';\r\nimport UserDTO, { UserGenderType, UserRoleType, UserOccupationType } from '../../../dto/UserDTO';\r\nimport moment from 'moment';\r\n\r\nconst { Option } = Select;\r\n\r\nexport interface UserFormProps {\r\n  loggedUserId: number;\r\n  user: UserDTO | undefined;\r\n  personalArea?: boolean;\r\n  onCancel: () => void;\r\n  onSave: (user: UserDTO) => void;\r\n  onChangePassword?: () => void;\r\n}\r\n\r\nconst formItemLayout = {\r\n  labelCol: {\r\n    xs: { span: 24 },\r\n    sm: { span: 6 }\r\n  },\r\n  wrapperCol: {\r\n    xs: { span: 24 },\r\n    sm: { span: 18 }\r\n  }\r\n};\r\n\r\nconst tailLayout = {\r\n  wrapperCol: {\r\n    xs: { offset: 0, span: 24 },\r\n    sm: { offset: 6, span: 18 }\r\n  }\r\n};\r\n\r\nclass User extends React.Component<UserFormProps & FormComponentProps> {\r\n  private getInitialValueBirthDate = () => {\r\n    const { user } = this.props;\r\n    return user?.birth_date ? moment(user.birth_date) : undefined;\r\n  };\r\n\r\n  private handleSubmit = (e: any) => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        const userToSave: UserDTO = {\r\n          ...values,\r\n          birth_date: values.birth_date ? values.birth_date.format('YYYY-MM-DD') : undefined,\r\n          committeeUser: {\r\n            id: values.committeeUserId,\r\n            userId: values.id,\r\n            committeeId: values.committeeId,\r\n            role: values.role,\r\n            occupation: values.occupation,\r\n            disabled: values.disabled\r\n          }\r\n        };\r\n        this.props.onSave(userToSave);\r\n      }\r\n    });\r\n  };\r\n\r\n  private renderButtonSubmit = () => {\r\n    const btnStyle: any = {\r\n      float: 'right'\r\n    };\r\n    if (this.props.personalArea) {\r\n      btnStyle['width'] = '100%';\r\n    }\r\n    return (\r\n      <Button htmlType=\"submit\" type=\"primary\" style={btnStyle}>\r\n        Salva\r\n      </Button>\r\n    );\r\n  };\r\n\r\n  private renderPasswordField = () => {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { personalArea, user } = this.props;\r\n    return getFieldDecorator('password', {\r\n      initialValue: user && user.id > 0 ? `12345678` : undefined,\r\n      rules: [{ required: true, message: 'Specificare la password' }]\r\n    })(\r\n      personalArea ? (\r\n        <Input.Password disabled={true} placeholder=\"Specificare la password\" />\r\n      ) : (\r\n        <Input disabled={user && user.id > 0} type=\"password\" placeholder=\"Specificare la password\" />\r\n      )\r\n    );\r\n  };\r\n\r\n  public render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { user, onCancel, onChangePassword, personalArea } = this.props;\r\n    return (\r\n      <Form {...formItemLayout} style={{ padding: '5px' }} layout=\"vertical\" onSubmit={this.handleSubmit}>\r\n        <Form.Item label=\"Username\">\r\n          {getFieldDecorator('username', {\r\n            initialValue: this.props.user?.username,\r\n            rules: [{ required: true, message: 'Specificare il nome utente' }]\r\n          })(<Input disabled={user && user.id > 0} placeholder=\"Specificare il nome utente\" />)}\r\n        </Form.Item>\r\n        <Form.Item label=\"Password\">\r\n          {personalArea ? (\r\n            <Row gutter={2}>\r\n              <Col xs={{ span: 14 }} lg={{ span: 20 }}>\r\n                {this.renderPasswordField()}\r\n              </Col>\r\n              <Col xs={{ span: 10 }} lg={{ span: 4 }}>\r\n                <Button onClick={onChangePassword} style={{ width: '100%' }}>\r\n                  Modifica\r\n                </Button>\r\n              </Col>\r\n            </Row>\r\n          ) : (\r\n            this.renderPasswordField()\r\n          )}\r\n        </Form.Item>\r\n        <Form.Item label=\"Nome\">\r\n          {getFieldDecorator('name', {\r\n            initialValue: this.props.user?.name,\r\n            rules: [{ required: true, message: 'Specificare il nome' }]\r\n          })(<Input placeholder=\"Specificare il nome\" />)}\r\n        </Form.Item>\r\n        <Form.Item label=\"Cognome\">\r\n          {getFieldDecorator('surname', {\r\n            initialValue: this.props.user?.surname,\r\n            rules: [{ required: true, message: 'Specificare il cognome' }]\r\n          })(<Input placeholder=\"Specificare il cognome\" />)}\r\n        </Form.Item>\r\n        <Form.Item label=\"Data di nascita\">\r\n          {getFieldDecorator('birth_date', {\r\n            initialValue: this.getInitialValueBirthDate(),\r\n            rules: []\r\n          })(<DatePicker format=\"DD-MM-YYYY\" style={{ textAlign: 'left' }} />)}\r\n        </Form.Item>\r\n        <Form.Item label=\"Sesso\">\r\n          {getFieldDecorator('gender', {\r\n            initialValue: this.props.user?.gender,\r\n            rules: [\r\n              {\r\n                required: true,\r\n                message: 'Specificare il sesso'\r\n              }\r\n            ]\r\n          })(\r\n            <Select placeholder=\"Sesso\">\r\n              <Option value={0}>{UserGenderType[0]}</Option>\r\n              <Option value={1}>{UserGenderType[1]}</Option>\r\n            </Select>\r\n          )}\r\n        </Form.Item>\r\n        <Form.Item label=\"Email\">\r\n          {getFieldDecorator('email', {\r\n            initialValue: this.props.user?.email,\r\n            rules: []\r\n          })(<Input placeholder=\"Specificare l'email\" />)}\r\n        </Form.Item>\r\n        <Form.Item label=\"Cellulare\">\r\n          {getFieldDecorator('cellphoneNumber', {\r\n            initialValue: this.props.user?.cellphoneNumber,\r\n            rules: []\r\n          })(<Input placeholder=\"Specificare numero di cellulare\" />)}\r\n        </Form.Item>\r\n        {personalArea && <Form.Item {...tailLayout}>{this.renderButtonSubmit()}</Form.Item>}\r\n        <div style={{ visibility: personalArea ? 'collapse' : 'visible' }}>\r\n          <Form.Item label=\"Ruolo\">\r\n            {getFieldDecorator('role', {\r\n              initialValue: this.props.user?.committeeUser.role,\r\n              rules: [\r\n                {\r\n                  required: true,\r\n                  message: 'Specificare il ruolo'\r\n                }\r\n              ]\r\n            })(\r\n              <Select placeholder=\"Role\">\r\n                <Option value={1}>{UserRoleType[1]}</Option>\r\n                <Option value={2}>{UserRoleType[2]}</Option>\r\n              </Select>\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label=\"Occupazione\">\r\n            {getFieldDecorator('occupation', {\r\n              initialValue: this.props.user?.committeeUser.occupation,\r\n              rules: [\r\n                {\r\n                  required: true,\r\n                  message: `Specificare l'occupazione`\r\n                }\r\n              ]\r\n            })(\r\n              <Select placeholder=\"Occupazione\">\r\n                <Option value={0}>{UserOccupationType[0]}</Option>\r\n                <Option value={1}>{UserOccupationType[1]}</Option>\r\n                <Option value={2}>{UserOccupationType[2]}</Option>\r\n              </Select>\r\n            )}\r\n          </Form.Item>\r\n        </div>\r\n        <div style={{ visibility: personalArea ? 'collapse' : 'visible' }}>\r\n          <Form.Item label=\"Con patente\">\r\n            {getFieldDecorator('withDrivingLicense', {\r\n              initialValue: this.props.user?.withDrivingLicense,\r\n              valuePropName: 'checked'\r\n            })(<Switch />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"Disabilita\">\r\n            {getFieldDecorator('disabled', {\r\n              initialValue: this.props.user?.committeeUser.disabled,\r\n              valuePropName: 'checked'\r\n            })(<Switch />)}\r\n          </Form.Item>\r\n        </div>\r\n        <div style={{ visibility: 'collapse' }}>\r\n          <Form.Item label=\"Id\">\r\n            {getFieldDecorator('id', {\r\n              initialValue: this.props.user?.id\r\n            })(<Input placeholder=\"Specificare id utente\" />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"Password modificata\">\r\n            {getFieldDecorator('flgPasswordChanged', {\r\n              initialValue: this.props.user?.flgPasswordChanged\r\n            })(<Input placeholder=\"Password modificata\" />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"CommitteeUserId\">\r\n            {getFieldDecorator('committeeUserId', {\r\n              initialValue: this.props.user?.committeeUser.id\r\n            })(<Input placeholder=\"CommitteeUserId\" />)}\r\n          </Form.Item>\r\n          <Form.Item label=\"CommitteeId\">\r\n            {getFieldDecorator('committeeId', {\r\n              initialValue: this.props.user?.committeeUser.committeeId\r\n            })(<Input placeholder=\"CommitteeId\" />)}\r\n          </Form.Item>\r\n        </div>\r\n        {personalArea ? undefined : (\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              right: 0,\r\n              bottom: 0,\r\n              width: '100%',\r\n              borderTop: '1px solid #e9e9e9',\r\n              padding: '10px 16px',\r\n              background: '#fff',\r\n              textAlign: 'right'\r\n            }}\r\n          >\r\n            <Button onClick={onCancel} style={{ marginRight: 8 }}>\r\n              Annulla\r\n            </Button>\r\n            {this.renderButtonSubmit()}\r\n          </div>\r\n        )}\r\n      </Form>\r\n    );\r\n  }\r\n}\r\n\r\nconst UserContainer = Form.create({ name: 'user_form ' })(User);\r\nclass UserForm extends React.Component<UserFormProps> {\r\n  public render() {\r\n    return <UserContainer {...this.props} />;\r\n  }\r\n}\r\n\r\nexport default UserForm;\r\n","import * as React from 'react';\r\nimport { Input, Modal, message } from 'antd';\r\n\r\nexport interface ChangePasswordModalProps {\r\n  changePasswordModalVisible: boolean;\r\n  onPasswordChangeConfirm: (oldPassword: string, newPassword: string) => void;\r\n  onPasswordChangeCancel: (e: React.MouseEvent<HTMLElement>) => void;\r\n}\r\n\r\ninterface ChangePasswordModalState {\r\n  oldPassword?: string;\r\n  newPassword?: string;\r\n  newPasswordConfirm?: string;\r\n}\r\n\r\nclass ChangePasswordModal extends React.Component<ChangePasswordModalProps, ChangePasswordModalState> {\r\n  state = {\r\n    oldPassword: undefined,\r\n    newPassword: undefined,\r\n    newPasswordConfirm: undefined\r\n  };\r\n\r\n  private onChangeOldPassowrd = (e: any) => {\r\n    this.setState({ oldPassword: e.target.value });\r\n  };\r\n\r\n  private onChangeNewPassword = (e: any) => {\r\n    this.setState({ newPassword: e.target.value });\r\n  };\r\n\r\n  private onChangeNewPasswordConfirm = (e: any) => {\r\n    this.setState({ newPasswordConfirm: e.target.value });\r\n  };\r\n\r\n  private handlePasswordChangeConfirm = (e: React.MouseEvent<HTMLElement>): void => {\r\n    const { oldPassword, newPassword, newPasswordConfirm } = this.state;\r\n    if (!oldPassword || !newPassword || !newPasswordConfirm) {\r\n      message.error('Completare correttamente i campi');\r\n      return;\r\n    }\r\n    if (newPassword !== newPasswordConfirm) {\r\n      message.error('Digitare correttamente la nuova password');\r\n      return;\r\n    }\r\n    if (newPassword === oldPassword) {\r\n      message.error('La nuova password non può coincidere con la vecchia password');\r\n      return;\r\n    }\r\n\r\n    this.props.onPasswordChangeConfirm(oldPassword || '', newPassword || '');\r\n  };\r\n\r\n  public render() {\r\n    const { changePasswordModalVisible, onPasswordChangeCancel: handlePasswordChangeCancel } = this.props;\r\n    return (\r\n      <Modal\r\n        title=\"Modifica password\"\r\n        visible={changePasswordModalVisible}\r\n        onOk={this.handlePasswordChangeConfirm}\r\n        onCancel={handlePasswordChangeCancel}\r\n        cancelText=\"Annulla\"\r\n        okText=\"Conferma\"\r\n      >\r\n        <div>\r\n          <Input.Password placeholder=\"Inserisci password corrente\" onChange={this.onChangeOldPassowrd} />\r\n          <Input.Password style={{ marginTop: '5px' }} placeholder=\"Inserisci nuova password\" onChange={this.onChangeNewPassword} />\r\n          <Input.Password style={{ marginTop: '5px' }} placeholder=\"Conferma nuova password\" onChange={this.onChangeNewPasswordConfirm} />\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ChangePasswordModal;\r\n","import * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { WithUser, WithConnector } from '../../reducers/reducers';\r\nimport { Row, Col, message } from 'antd';\r\nimport UserForm from './forms/UserForm';\r\nimport UserDTO from '../../dto/UserDTO';\r\nimport { RouterProps } from 'react-router';\r\nimport { SetUserDataProps, setUserData } from '../../actions/action';\r\nimport ChangePasswordModal from '../common/ChangePasswordModal';\r\n\r\ninterface PersonalAreaProps extends WithUser, WithConnector, SetUserDataProps, RouterProps {}\r\n\r\ninterface PersonalAreaState {\r\n  passwordChangeFormVisible: boolean;\r\n}\r\n\r\nclass PersonalArea extends React.Component<PersonalAreaProps, PersonalAreaState> {\r\n  state = {\r\n    passwordChangeFormVisible: false\r\n  };\r\n\r\n  private _onCancel = () => {\r\n    this.props.history.goBack();\r\n  };\r\n\r\n  private _onSave = (userToPublish: UserDTO) => {\r\n    const { user } = this.props;\r\n    this.props.connector\r\n      .publishUser(userToPublish)\r\n      .then((res) => {\r\n        this.props.setUserData(userToPublish, user?.committeeUser.id || 0);\r\n        message.success('Salvataggio completato');\r\n      })\r\n      .catch((err) => {\r\n        console.error(`_onSave: error ${err}`);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onChangePassword = () => {\r\n    this.setState({ passwordChangeFormVisible: true });\r\n  };\r\n\r\n  private _onPasswordChangeConfirm = (oldPassword: string, newPassword: string): void => {\r\n    const { connector } = this.props;\r\n    connector\r\n      .modifyPassword(oldPassword || '', newPassword || '')\r\n      .then((res: any) => {\r\n        this.setState(\r\n          {\r\n            passwordChangeFormVisible: false\r\n          },\r\n          () => message.success('Password modificata correttamente')\r\n        );\r\n      })\r\n      .catch((err: any) => {\r\n        let errorMessage: string = 'Si è verificato un errore nella richiesta';\r\n        const { response } = err;\r\n        if (response && response.data && response.data && response.data.message) {\r\n          errorMessage = response.data.message;\r\n        }\r\n        message.error(errorMessage);\r\n      });\r\n  };\r\n\r\n  private _onPasswordChangeCancel = (e: React.MouseEvent<HTMLElement>): void => {\r\n    this.setState({\r\n      passwordChangeFormVisible: false\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { user } = this.props;\r\n    return (\r\n      <Row>\r\n        <Col xs={{ span: 0 }} lg={{ span: 3 }} />\r\n        <Col xs={{ span: 24 }} lg={{ span: 16 }} style={{ marginTop: '10px' }}>\r\n          <UserForm\r\n            loggedUserId={(user as UserDTO).id}\r\n            user={user}\r\n            personalArea={true}\r\n            onCancel={this._onCancel}\r\n            onSave={this._onSave}\r\n            onChangePassword={this._onChangePassword}\r\n          />\r\n        </Col>\r\n        <Col xs={{ span: 0 }} lg={{ span: 3 }} />\r\n        <ChangePasswordModal\r\n          changePasswordModalVisible={this.state.passwordChangeFormVisible}\r\n          onPasswordChangeCancel={this._onPasswordChangeCancel}\r\n          onPasswordChangeConfirm={this._onPasswordChangeConfirm}\r\n        />\r\n      </Row>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    connector: state.appData.connector,\r\n    committee: state.appData.committee\r\n  };\r\n};\r\nconst PersonalAreaContainer = connect(mapStateToProps, {\r\n  setUserData\r\n})(PersonalArea);\r\nexport default PersonalAreaContainer;\r\n","import * as React from 'react';\r\nimport { Menu, Icon } from 'antd';\r\nimport { Links } from '../../../../utils/Links';\r\nimport { RouterProps } from 'react-router';\r\nimport { MenuMode } from 'antd/lib/menu';\r\n\r\nexport interface RedCrossMenuProps extends RouterProps {\r\n  isUserAdmin: boolean;\r\n  menuMode: MenuMode;\r\n  onClickMenu?: () => void;\r\n}\r\n\r\nclass RedCrossMenu extends React.Component<RedCrossMenuProps> {\r\n  onClickMenuItem = (link: string) => {\r\n    const { history, onClickMenu } = this.props;\r\n    if (onClickMenu) {\r\n      onClickMenu();\r\n    }\r\n    history.push(link);\r\n  };\r\n\r\n  public render() {\r\n    const { isUserAdmin, menuMode } = this.props;\r\n    return (\r\n      <Menu theme=\"dark\" defaultSelectedKeys={['1']} mode={menuMode}>\r\n        <Menu.Item key=\"1\" onClick={() => this.onClickMenuItem(Links.DESKTOP_SERVICES)}>\r\n          <Icon type=\"calendar\" />\r\n          <span>Gestione Servizi</span>\r\n        </Menu.Item>\r\n        {isUserAdmin ? (\r\n          <Menu.Item key=\"2\" onClick={() => this.onClickMenuItem(Links.DESKTOP_USERS)}>\r\n            <Icon type=\"team\" />\r\n            <span>Gestione Utenti</span>\r\n          </Menu.Item>\r\n        ) : undefined}\r\n        {isUserAdmin ? (\r\n          <Menu.Item key=\"3\" onClick={() => this.onClickMenuItem(Links.DESKTOP_VEHICLES)}>\r\n            <Icon type=\"car\" />\r\n            <span>Gestione Veicoli</span>\r\n          </Menu.Item>\r\n        ) : undefined}\r\n        <Menu.Item key=\"4\" onClick={() => this.onClickMenuItem(Links.DESKTOP_PERSONAL_AREA)}>\r\n          <Icon type=\"user\" />\r\n          <span>Area personale</span>\r\n        </Menu.Item>\r\n      </Menu>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RedCrossMenu;\r\n","import * as React from 'react';\r\nimport { Layout } from 'antd';\r\nimport { RouterProps } from 'react-router';\r\nimport RedCrossMenu from './base/RedCrossMenu';\r\nconst { Sider } = Layout;\r\n\r\nexport interface RedCrossSiderProps extends RouterProps {\r\n  isUserAdmin: boolean;\r\n}\r\n\r\ninterface RedCrossSiderState {\r\n  collapsed: boolean;\r\n}\r\n\r\nclass RedCrossSider extends React.Component<RedCrossSiderProps, RedCrossSiderState> {\r\n  constructor(props: RedCrossSiderProps) {\r\n    super(props);\r\n    this.state = {\r\n      collapsed: true\r\n    };\r\n  }\r\n\r\n  _onCollapse = (collapsed: any) => {\r\n    this.setState({ collapsed });\r\n  };\r\n\r\n  _onClickMenu = () => {\r\n    this.setState({ collapsed: true });\r\n  };\r\n\r\n  public render() {\r\n    const { isUserAdmin, history } = this.props;\r\n    return (\r\n      <Sider collapsible collapsed={this.state.collapsed} onCollapse={this._onCollapse}>\r\n        <div style={{ height: '60px', width: '100%' }} />\r\n        <RedCrossMenu isUserAdmin={isUserAdmin} history={history} menuMode={'inline'} onClickMenu={this._onClickMenu} />\r\n      </Sider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RedCrossSider;\r\n","import React from 'react';\r\nimport { Button, Row, Col, Tooltip, Layout } from 'antd';\r\nimport { PORTAL_NAME } from '../../../utils/Constants';\r\nimport { WithUser, WithCommittee } from '../../../reducers/reducers';\r\n\r\nconst { Header } = Layout;\r\n\r\nexport interface RedCrossHeaderProps extends WithUser, WithCommittee {\r\n  onClickLogout: () => void;\r\n}\r\n\r\nclass RedCrossHeader extends React.Component<RedCrossHeaderProps> {\r\n  public render() {\r\n    const { committee, user, onClickLogout } = this.props;\r\n    return (\r\n      <Header style={{ background: '#001529', maxHeight: '64px', width: '100%', padding: 0, position: 'fixed', zIndex: 10, left: 0 }}>\r\n        <Row>\r\n          <Col span={16} style={{ textAlign: 'left' }}>\r\n            <span\r\n              style={{\r\n                color: 'white',\r\n                marginLeft: '15px',\r\n                fontStyle: 'bold',\r\n                fontSize: 'larger'\r\n              }}\r\n            >\r\n              {PORTAL_NAME}\r\n            </span>\r\n            -\r\n            <span\r\n              style={{\r\n                color: 'white',\r\n                marginLeft: '5px',\r\n                fontStyle: 'italic'\r\n              }}\r\n            >\r\n              {committee?.description}\r\n            </span>\r\n          </Col>\r\n          <Col span={7} style={{ textAlign: 'right' }}>\r\n            <span style={{ color: 'white', marginRight: '5px' }}>\r\n              {user?.name} {user?.surname}\r\n            </span>\r\n          </Col>\r\n          <Col span={1}>\r\n            <Tooltip title=\"Logout\" placement=\"bottom\">\r\n              <Button ghost icon=\"logout\" style={{ height: '64px', width: '100%' }} onClick={onClickLogout} />\r\n            </Tooltip>\r\n          </Col>\r\n        </Row>\r\n      </Header>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RedCrossHeader;\r\n","import React from 'react';\r\nimport { Layout } from 'antd';\r\nimport { RouterProps } from 'react-router';\r\nimport RedCrossMenu from './base/RedCrossMenu';\r\n\r\nconst { Footer } = Layout;\r\n\r\nexport interface RedCrossFooterProps extends RouterProps {\r\n  isUserAdmin: boolean;\r\n}\r\n\r\nclass RedCrossFooter extends React.Component<RedCrossFooterProps> {\r\n  public render() {\r\n    const { history, isUserAdmin } = this.props;\r\n    return (\r\n      <Footer style={{ width: '100%', position: 'fixed', left: 0, bottom: 0, padding: '0px' }}>\r\n        <RedCrossMenu isUserAdmin={isUserAdmin} history={history} menuMode={'horizontal'} />\r\n      </Footer>\r\n    );\r\n  }\r\n}\r\nexport default RedCrossFooter;\r\n","import * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { WithConnector, WithCommittee, WithUser, WithUsers } from '../../reducers/reducers';\r\nimport { Spin, Button, Popconfirm, Icon, Tooltip, Drawer, Row } from 'antd';\r\nimport { message, Table } from 'antd';\r\nimport 'react-tiny-fab/dist/styles.css';\r\nimport PlusFabButton from './base/PlusFabButton';\r\nimport UserDTO, { UserRoleType, UserOccupationType } from '../../dto/UserDTO';\r\nimport { setUsersData, SetUsersDataProps } from '../../actions/action';\r\nimport TripUsersDTO from '../../dto/TripUsersDTO';\r\nimport UserForm from './forms/UserForm';\r\n\r\ninterface IUsersState {\r\n  loading: boolean;\r\n  showForm: boolean;\r\n  selectedUser?: UserDTO;\r\n}\r\n\r\nclass Users extends React.Component<WithUser & WithUsers & WithConnector & WithCommittee & SetUsersDataProps, IUsersState> {\r\n  columns = [\r\n    {\r\n      title: 'Username',\r\n      dataIndex: 'username',\r\n      key: 'username',\r\n      render: (value: any, record: any) => <b>{value}</b>\r\n    },\r\n    {\r\n      title: 'Nome',\r\n      dataIndex: 'name',\r\n      key: 'name'\r\n    },\r\n    {\r\n      title: 'Cognome',\r\n      dataIndex: 'surname',\r\n      key: 'surname'\r\n    },\r\n    {\r\n      title: 'Data di nascita',\r\n      dataIndex: 'birth_date',\r\n      key: 'birth_date'\r\n    },\r\n    {\r\n      title: 'Ruolo',\r\n      dataIndex: 'committeeUser.role',\r\n      key: 'role',\r\n      render: (value: any, record: any) => <span>{UserRoleType[value]}</span>\r\n    },\r\n    {\r\n      title: 'Occupazione',\r\n      dataIndex: 'committeeUser.occupation',\r\n      key: 'occupation',\r\n      render: (value: any, record: any) => <span>{UserOccupationType[value]}</span>\r\n    },\r\n    {\r\n      title: 'Con patente',\r\n      dataIndex: 'withDrivingLicense',\r\n      key: 'withDrivingLicense',\r\n      render: (value: any, record: any) => <p>{value === 0 ? undefined : <Icon type=\"check\" />}</p>\r\n    },\r\n    {\r\n      title: 'Disabilitato',\r\n      dataIndex: 'committeeUser.disabled',\r\n      key: 'disabled',\r\n      render: (value: any, record: any) => <p>{value === 0 ? undefined : <Icon type=\"check\" />}</p>\r\n    },\r\n    {\r\n      title: '',\r\n      key: 'action',\r\n      render: (text: any, record: UserDTO) => (\r\n        <span>\r\n          <Tooltip title=\"Modifica\">\r\n            <Button size=\"small\" icon=\"edit\" onClick={() => this._onEditRow(record)} />\r\n          </Tooltip>\r\n          <Popconfirm\r\n            placement=\"topLeft\"\r\n            title={`Confermare l'eliminazione dell'utente?`}\r\n            onConfirm={() => this._onDeleteUser(record)}\r\n            okText=\"Si\"\r\n            cancelText=\"No\"\r\n          >\r\n            <Button size=\"small\" style={{ marginLeft: '1px' }} icon=\"delete\" type=\"danger\" />\r\n          </Popconfirm>\r\n        </span>\r\n      )\r\n    }\r\n  ];\r\n\r\n  emptyUser: UserDTO = {\r\n    id: 0,\r\n    username: '',\r\n    password: '',\r\n    flgPasswordChanged: 0,\r\n    name: '',\r\n    surname: '',\r\n    gender: 0,\r\n    withDrivingLicense: 0,\r\n    superuser: 0,\r\n    committeeUser: {\r\n      id: 0,\r\n      committeeId: this.props.committee?.id || 0,\r\n      userId: 0,\r\n      role: 2,\r\n      occupation: 0,\r\n      disabled: 0\r\n    }\r\n  };\r\n\r\n  state: IUsersState = {\r\n    loading: false,\r\n    showForm: false\r\n  };\r\n\r\n  private loadData = () => {\r\n    const { committee } = this.props;\r\n    if (committee !== undefined) {\r\n      this.props.connector\r\n        .getUsers(committee.id)\r\n        .then((res) => {\r\n          this.setState({ loading: false }, () => {\r\n            this.props.setUsersData(res.data);\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          message.error(`Si è verificato un errore nella lettura degli utenti`);\r\n          this.setState({ loading: false });\r\n          console.error(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  private _onClose = () => {\r\n    this.setState({ showForm: false, selectedUser: undefined });\r\n  };\r\n\r\n  private _onEditRow = (selectedUser: UserDTO) => {\r\n    this.setState({ selectedUser, showForm: true });\r\n  };\r\n\r\n  private _onDeleteUser = (user: UserDTO) => {\r\n    this.props.connector\r\n      .getUserTrips(user.id)\r\n      .then((res) => {\r\n        const tripUsers: TripUsersDTO[] = res.data || [];\r\n        if (tripUsers.length > 0) {\r\n          message.error(`Utente già assegnato a servizi. Impossibile eliminare`);\r\n          return;\r\n        }\r\n        this.props.connector\r\n          .deleteCommitteesUsers(user.id)\r\n          .then((res) => {\r\n            this.props.connector\r\n              .deleteUser(user.id)\r\n              .then((res) => {\r\n                this.loadData();\r\n              })\r\n              .catch((err) => {\r\n                console.error(`_onDeleteUser - deleteUser: ${err}`);\r\n                message.error(`Si è verificato un errore durante l'eliminazione`);\r\n              });\r\n          })\r\n          .catch((err) => {\r\n            console.error(`_onDeleteUser - deleteCommitteesUsers: ${err}`);\r\n            message.error(`Si è verificato un errore durante l'eliminazione`);\r\n          });\r\n      })\r\n      .catch((err) => {\r\n        console.error(`_onDeleteUser - getUserTrips: ${err}`);\r\n        message.error(`Si è verificato un errore durante l'eliminazione`);\r\n      });\r\n  };\r\n\r\n  private _onSave = (user: UserDTO) => {\r\n    const { committeeUser } = user;\r\n    if (!committeeUser) {\r\n      console.warn(`Expected NOT NULL 'committee' - This should never happen!`);\r\n      message.error('Si è verificato un errore nel salvataggio');\r\n      return;\r\n    }\r\n    this.props.connector\r\n      .publishUserCommittee(user, committeeUser)\r\n      .then((res) => {\r\n        message.success('Salvataggio completato');\r\n        this.setState({ showForm: false, selectedUser: undefined }, () => {\r\n          this.loadData();\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onCreate = () => {\r\n    this.setState({ selectedUser: this.emptyUser, showForm: true });\r\n  };\r\n\r\n  private getDataSource = (): UserDTO[] => {\r\n    const { user, users } = this.props;\r\n    if (user !== undefined) {\r\n      // Un utente NON superuser può gestire solo utenti Admin e User\r\n      if (user.superuser === 0) {\r\n        return users.filter((user: UserDTO) => user.superuser === 0);\r\n      }\r\n      return users;\r\n    } else {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  public render() {\r\n    const { loading, selectedUser, showForm } = this.state;\r\n    return (\r\n      <div>\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center' }}>\r\n            <Spin />\r\n          </div>\r\n        ) : (\r\n          <Row>\r\n            <Table columns={this.columns} pagination={{ pageSize: 10 }} dataSource={this.getDataSource()} />\r\n            <Drawer\r\n              title={`${(selectedUser as any)?.id === 0 ? 'Crea' : 'Modifica'} utente`}\r\n              width={640}\r\n              onClose={this._onClose}\r\n              visible={showForm}\r\n              bodyStyle={{ paddingBottom: 80 }}\r\n            >\r\n              {showForm ? <UserForm loggedUserId={this.props.user?.id || 0} user={selectedUser} onCancel={this._onClose} onSave={this._onSave} /> : undefined}\r\n            </Drawer>\r\n            {showForm ? undefined : <PlusFabButton onClick={this._onCreate} />}\r\n          </Row>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    connector: state.appData.connector,\r\n    committee: state.appData.committee,\r\n    users: state.appData.users\r\n  };\r\n};\r\nconst UsersContainer = connect(mapStateToProps, { setUsersData })(Users);\r\nexport default UsersContainer;\r\n","import * as React from 'react';\r\nimport { Drawer, Form, Button, Col, Row, Input, Select, Switch } from 'antd';\r\nimport VehicleDTO, { VehicleType } from '../../../dto/VehicleDTO';\r\nimport { FormComponentProps } from 'antd/lib/form/Form';\r\n\r\nconst { Option } = Select;\r\n\r\nexport interface IVehicleFormProps {\r\n  visible: boolean;\r\n  vehicle: VehicleDTO | undefined;\r\n  onClose: () => void;\r\n  onSave: (vehicle: VehicleDTO) => void;\r\n}\r\n\r\nclass Vehicle extends React.Component<IVehicleFormProps & FormComponentProps> {\r\n  componentWillReceiveProps(nextProps: IVehicleFormProps & FormComponentProps) {\r\n    const { vehicle } = nextProps;\r\n    if (\r\n      vehicle !== undefined &&\r\n      JSON.stringify(this.props.vehicle) !== JSON.stringify(nextProps.vehicle)\r\n    ) {\r\n      const { form } = nextProps;\r\n      form.setFieldsValue({\r\n        type: vehicle.type,\r\n        plate: vehicle.plate,\r\n        sign: vehicle.sign,\r\n        description: vehicle.description,\r\n        disabled: vehicle.disabled\r\n      });\r\n    }\r\n  }\r\n\r\n  private handleSubmit = (e: any) => {\r\n    e.preventDefault();\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        const { vehicle } = this.props;\r\n        const vehicleToSave: VehicleDTO = {\r\n          ...values,\r\n          id: (vehicle as any).id,\r\n          committeeId: (vehicle as any).committeeId,\r\n          committee: (vehicle as any).committee\r\n        };\r\n        this.props.onSave(vehicleToSave);\r\n      }\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    return (\r\n      <Drawer\r\n        title={`${this.props.vehicle?.id === 0 ? 'Crea' : 'Modifica'} veicolo`}\r\n        width={480}\r\n        onClose={this.props.onClose}\r\n        visible={this.props.visible}\r\n        bodyStyle={{ paddingBottom: 80 }}\r\n      >\r\n        <Form layout=\"vertical\" onSubmit={this.handleSubmit}>\r\n          <Row gutter={16}>\r\n            <Col span={24}>\r\n              <Form.Item label=\"Tipo\">\r\n                {getFieldDecorator('type', {\r\n                  rules: [\r\n                    {\r\n                      required: true,\r\n                      message: 'Specificare il tipo'\r\n                    }\r\n                  ],\r\n                  initialValue: '0'\r\n                })(\r\n                  <Select placeholder=\"Tipologia\">\r\n                    <Option value={0}>{VehicleType[0]}</Option>\r\n                    <Option value={1}>{VehicleType[1]}</Option>\r\n                    <Option value={2}>{VehicleType[2]}</Option>\r\n                  </Select>\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={24}>\r\n              <Form.Item label=\"Targa\">\r\n                {getFieldDecorator('plate', {\r\n                  rules: [{ required: true, message: 'Specificare la targa' }]\r\n                })(<Input placeholder=\"Specificare la targa\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={24}>\r\n              <Form.Item label=\"Sigla\">\r\n                {getFieldDecorator('sign', {\r\n                  rules: [{ required: false, message: 'Specificare la sigla' }]\r\n                })(<Input placeholder=\"Specificare una sigla\" />)}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={16}>\r\n            <Col span={24}>\r\n              <Form.Item label=\"Descrizione\">\r\n                {getFieldDecorator('description', {\r\n                  rules: [\r\n                    {\r\n                      required: false\r\n                    }\r\n                  ]\r\n                })(\r\n                  <Input.TextArea\r\n                    rows={4}\r\n                    placeholder=\"Specificare una descrizione\"\r\n                  />\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row>\r\n            <Col span={12}>\r\n              <Form.Item label=\"Disabilita\">\r\n                {getFieldDecorator('disabled', { valuePropName: 'checked' })(\r\n                  <Switch />\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              right: 0,\r\n              bottom: 0,\r\n              width: '100%',\r\n              borderTop: '1px solid #e9e9e9',\r\n              padding: '10px 16px',\r\n              background: '#fff',\r\n              textAlign: 'right'\r\n            }}\r\n          >\r\n            <Button onClick={this.props.onClose} style={{ marginRight: 8 }}>\r\n              Annulla\r\n            </Button>\r\n            <Button htmlType=\"submit\" type=\"primary\">\r\n              Salva\r\n            </Button>\r\n          </div>\r\n        </Form>\r\n      </Drawer>\r\n    );\r\n  }\r\n}\r\n\r\nconst VehicleContainer = Form.create({ name: 'vehicle_form ' })(Vehicle);\r\nclass VehicleForm extends React.Component<IVehicleFormProps> {\r\n  public render() {\r\n    return <VehicleContainer {...this.props} />;\r\n  }\r\n}\r\n\r\nexport default VehicleForm;\r\n","import * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport VehicleDTO, { VehicleType } from '../../dto/VehicleDTO';\r\nimport { WithConnector, WithCommittee } from '../../reducers/reducers';\r\nimport { Spin, Button, Popconfirm, Tooltip, Icon, Row } from 'antd';\r\nimport { message, Table } from 'antd';\r\nimport 'react-tiny-fab/dist/styles.css';\r\nimport VehicleForm from './forms/VehicleForm';\r\nimport PlusFabButton from './base/PlusFabButton';\r\n\r\ninterface IVechiclesState {\r\n  loading: boolean;\r\n  showForm: boolean;\r\n  selectedVehicle: VehicleDTO | undefined;\r\n  vehicles: VehicleDTO[];\r\n}\r\n\r\nclass Vehicles extends React.Component<WithConnector & WithCommittee, IVechiclesState> {\r\n  columns = [\r\n    {\r\n      title: 'Targa',\r\n      dataIndex: 'plate',\r\n      key: 'plate'\r\n    },\r\n    {\r\n      title: 'Sigla',\r\n      dataIndex: 'sign',\r\n      key: 'sign'\r\n    },\r\n    {\r\n      title: 'Tipologia',\r\n      dataIndex: 'type',\r\n      key: 'type',\r\n      render: (value: any, record: any) => <span>{VehicleType[value]}</span>\r\n    },\r\n    {\r\n      title: 'Descrizione',\r\n      dataIndex: 'description',\r\n      key: 'description'\r\n    },\r\n    {\r\n      title: 'Disabilitato',\r\n      dataIndex: 'disabled',\r\n      key: 'disabled',\r\n      render: (value: any, record: any) => <p>{value === 0 ? undefined : <Icon type=\"close\" />}</p>\r\n    },\r\n    {\r\n      title: '',\r\n      key: 'action',\r\n      render: (text: any, record: VehicleDTO) => (\r\n        <span>\r\n          <Tooltip title=\"Modifica\">\r\n            <Button size=\"small\" icon=\"edit\" onClick={() => this._onEditVehicle(record)} />\r\n          </Tooltip>\r\n          <Popconfirm placement=\"topLeft\" title={`Confermare l'eliminazione?`} onConfirm={() => this._onDeleteVehicle(record)} okText=\"Si\" cancelText=\"No\">\r\n            <Button size=\"small\" style={{ marginLeft: '1px' }} icon=\"delete\" type=\"danger\" />\r\n          </Popconfirm>\r\n        </span>\r\n      )\r\n    }\r\n  ];\r\n\r\n  emptyVehicle: VehicleDTO = {\r\n    id: 0,\r\n    type: 0,\r\n    plate: '',\r\n    sign: '',\r\n    description: '',\r\n    disabled: 0,\r\n    committeeId: this.props.committee?.id || 0,\r\n    committee: this.props.committee as any\r\n  };\r\n\r\n  state = {\r\n    loading: true,\r\n    showForm: false,\r\n    selectedVehicle: undefined,\r\n    vehicles: []\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.loadData();\r\n  }\r\n\r\n  private loadData = () => {\r\n    const { committee } = this.props;\r\n    if (committee !== undefined) {\r\n      this.props.connector\r\n        .getVehicles(committee.id)\r\n        .then((res) => {\r\n          this.setState({\r\n            vehicles: res.data,\r\n            loading: false\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          this.setState({ vehicles: [], loading: false });\r\n          console.error(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  private _onClose = () => {\r\n    this.setState({ showForm: false, selectedVehicle: undefined });\r\n  };\r\n\r\n  private _onEditVehicle = (selectedVehicle: VehicleDTO) => {\r\n    this.setState({ selectedVehicle, showForm: true });\r\n  };\r\n\r\n  private _onDeleteVehicle = (vehicle: VehicleDTO) => {\r\n    this.props.connector.deleteVehicle(vehicle).then((res) => {\r\n      this.loadData();\r\n    });\r\n  };\r\n\r\n  private _onSave = (vehicle: VehicleDTO) => {\r\n    this.publishVehicle(vehicle);\r\n  };\r\n\r\n  private publishVehicle = (vehicle: VehicleDTO) => {\r\n    this.props.connector\r\n      .publishVehicle(vehicle)\r\n      .then((res) => {\r\n        message.success('Salvataggio completato');\r\n        this.setState({ showForm: false, selectedVehicle: undefined }, () => {\r\n          this.loadData();\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onCreate = () => {\r\n    this.setState({ selectedVehicle: this.emptyVehicle, showForm: true });\r\n  };\r\n\r\n  public render() {\r\n    const { loading, vehicles } = this.state;\r\n    return (\r\n      <div>\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center' }}>\r\n            <Spin />{' '}\r\n          </div>\r\n        ) : (\r\n          <Row>\r\n            <Table columns={this.columns} pagination={{ pageSize: 10 }} dataSource={vehicles} />\r\n            <VehicleForm visible={this.state.showForm} vehicle={this.state.selectedVehicle} onClose={this._onClose} onSave={this._onSave} />\r\n            {this.state.showForm ? undefined : <PlusFabButton onClick={this._onCreate} />}\r\n          </Row>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    connector: state.appData.connector,\r\n    committee: state.appData.committee\r\n  };\r\n};\r\nconst VehiclesContainer = connect(mapStateToProps)(Vehicles);\r\nexport default VehiclesContainer;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Layout } from 'antd';\r\nimport { Route } from 'react-router-dom';\r\nimport { Links } from '../../utils/Links';\r\nimport ServicesContainer from './Services';\r\nimport { WithUser, WithCommittee } from '../../reducers/reducers';\r\nimport { RouterProps } from 'react-router';\r\nimport { MAXIMUM_WIDTH_FOR_SMARTPHONE, MAXIMUM_WIDTH_FOR_TABLET } from '../../utils/Constants';\r\nimport { ResetAuthDataProps, resetAuthData } from '../../actions/action';\r\nimport PersonalAreaContainer from './PersonalArea';\r\nimport RedCrossSider from './layouts/RedCrossSider';\r\nimport RedCrossHeader from './layouts/RedCrossHeader';\r\nimport RedCrossFooter from './layouts/RedCrossFooter';\r\nimport UsersContainer from './Users';\r\nimport VehiclesContainer from './Vehicles';\r\n\r\nconst { Content } = Layout;\r\n\r\ninterface DashboardProps extends WithUser, WithCommittee, ResetAuthDataProps, RouterProps {}\r\n\r\ninterface DashboardState {\r\n  windowWidth: number;\r\n  windowHeight: number;\r\n}\r\n\r\nclass Dashboard extends React.Component<DashboardProps, DashboardState> {\r\n  constructor(props: DashboardProps) {\r\n    super(props);\r\n\r\n    const { user, committee } = this.props;\r\n    if (!user && !committee) {\r\n      this._onLogout();\r\n    }\r\n    this.state = {\r\n      windowWidth: 0,\r\n      windowHeight: 0\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.updateDimensions();\r\n    window.addEventListener('resize', this.updateDimensions.bind(this));\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.updateDimensions.bind(this));\r\n  }\r\n\r\n  updateDimensions() {\r\n    const windowWidth = typeof window !== 'undefined' ? window.innerWidth : 0;\r\n    const windowHeight = typeof window !== 'undefined' ? window.innerHeight : 0;\r\n\r\n    this.setState({ windowWidth, windowHeight });\r\n  }\r\n\r\n  _onClickLogout = () => {\r\n    this.props.resetAuthData();\r\n    this._onLogout();\r\n  };\r\n\r\n  _onLogout = () => {\r\n    this.props.history.replace(Links.LOGIN);\r\n  };\r\n\r\n  get isUserAdmin(): boolean {\r\n    const { user } = this.props;\r\n    if (user !== undefined && user.committeeUser !== undefined) {\r\n      return user?.committeeUser.role < 2;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  get isForSmartphone(): boolean {\r\n    const { windowWidth } = this.state;\r\n    return windowWidth <= MAXIMUM_WIDTH_FOR_SMARTPHONE;\r\n  }\r\n\r\n  get isForTablet(): boolean {\r\n    const { windowWidth } = this.state;\r\n    return windowWidth > MAXIMUM_WIDTH_FOR_SMARTPHONE && windowWidth < MAXIMUM_WIDTH_FOR_TABLET;\r\n  }\r\n\r\n  get isForDesktop(): boolean {\r\n    const { windowWidth } = this.state;\r\n    return windowWidth >= MAXIMUM_WIDTH_FOR_TABLET;\r\n  }\r\n\r\n  public render() {\r\n    const { user, committee } = this.props;\r\n    return (\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        {this.isForDesktop ? <RedCrossSider isUserAdmin={this.isUserAdmin} history={this.props.history} /> : undefined}\r\n        <Layout>\r\n          <RedCrossHeader committee={committee} user={user} onClickLogout={this._onClickLogout} />\r\n          <Content style={{ marginTop: '68px' }}>\r\n            <Route path={Links.DESKTOP_USERS} exact={true} component={UsersContainer} />\r\n            <Route path={Links.DESKTOP_VEHICLES} exact={true} component={VehiclesContainer} />\r\n            <Route path={Links.DESKTOP_PERSONAL_AREA} exact={true} component={PersonalAreaContainer} />\r\n            <Route path={Links.DESKTOP_SERVICES} component={ServicesContainer} />\r\n          </Content>\r\n          {!this.isForDesktop ? <RedCrossFooter isUserAdmin={this.isUserAdmin} history={this.props.history} /> : undefined}\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    committee: state.appData.committee\r\n  };\r\n};\r\nconst DashboardContainer = connect(mapStateToProps, { resetAuthData })(Dashboard);\r\nexport default DashboardContainer;\r\n","import * as React from 'react';\r\nimport moment from 'moment';\r\nimport { connect } from 'react-redux';\r\nimport { WithUser, WithConnector } from '../../reducers/reducers';\r\nimport { message } from 'antd';\r\nimport UserDTO from '../../dto/UserDTO';\r\nimport { RouterProps } from 'react-router';\r\nimport { SetUserDataProps, setUserData } from '../../actions/action';\r\nimport { createForm } from 'rc-form';\r\nimport { List, InputItem, Button, Picker, WhiteSpace, DatePicker, LocaleProvider } from 'antd-mobile';\r\nimport { PickerData } from 'antd-mobile/lib/picker/PropsType';\r\nimport ChangePasswordModal from '../common/ChangePasswordModal';\r\nimport enUS from 'antd-mobile/lib/locale-provider/en_US';\r\n\r\ninterface PersonalAreaMobileProps extends WithUser, WithConnector, SetUserDataProps, RouterProps {\r\n  form: any;\r\n}\r\n\r\ninterface PersonalAreaMobileState {\r\n  passwordChangeFormVisible: boolean;\r\n}\r\n\r\nclass PersonalAreaMobile extends React.Component<PersonalAreaMobileProps, PersonalAreaMobileState> {\r\n  state = {\r\n    passwordChangeFormVisible: false\r\n  };\r\n\r\n  private onSaveUser = (userToPublish: UserDTO) => {\r\n    const { user } = this.props;\r\n    this.props.connector\r\n      .publishUser(userToPublish)\r\n      .then((res) => {\r\n        this.props.setUserData(userToPublish, user?.committeeUser.id || 0);\r\n        message.success('Salvataggio completato');\r\n      })\r\n      .catch((err) => {\r\n        console.error(`_onSave: error ${err}`);\r\n        message.error('Si è verificato un errore nel salvataggio');\r\n      });\r\n  };\r\n\r\n  private _onChangePassword = () => {\r\n    this.setState({ passwordChangeFormVisible: true });\r\n  };\r\n\r\n  private _onPasswordChangeConfirm = (oldPassword: string, newPassword: string): void => {\r\n    const { connector } = this.props;\r\n    connector\r\n      .modifyPassword(oldPassword || '', newPassword || '')\r\n      .then((res: any) => {\r\n        this.setState(\r\n          {\r\n            passwordChangeFormVisible: false\r\n          },\r\n          () => message.success('Password modificata correttamente')\r\n        );\r\n      })\r\n      .catch((err: any) => {\r\n        let errorMessage: string = 'Si è verificato un errore nella richiesta';\r\n        const { response } = err;\r\n        if (response && response.data && response.data && response.data.message) {\r\n          errorMessage = response.data.message;\r\n        }\r\n        message.error(errorMessage);\r\n      });\r\n  };\r\n\r\n  private _onPasswordChangeCancel = (e: React.MouseEvent<HTMLElement>): void => {\r\n    this.setState({\r\n      passwordChangeFormVisible: false\r\n    });\r\n  };\r\n\r\n  private _onSubmit = () => {\r\n    this.props.form.validateFields((error: any, values: any) => {\r\n      let allErrors: string[] = [];\r\n      if (error !== null && error !== undefined) {\r\n        for (let key in error) {\r\n          const propertyError: any = error[key];\r\n          if (propertyError && propertyError.errors) {\r\n            const { errors } = propertyError;\r\n            if (errors.length > 0) {\r\n              allErrors = [...allErrors, errors[0].message];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (allErrors.length > 0) {\r\n        allErrors.map((allError: string) => message.warn(allError));\r\n        return;\r\n      }\r\n      const { user } = this.props;\r\n      const userToSave: UserDTO = {\r\n        ...user,\r\n        ...values,\r\n        birth_date: values.birth_date ? moment(values.birth_date).format('YYYY-MM-DD') : undefined,\r\n        gender: values.gender[0]\r\n      };\r\n      this.onSaveUser(userToSave);\r\n    });\r\n  };\r\n\r\n  private getPickerGenderData = (): PickerData[] => {\r\n    return [\r\n      {\r\n        value: 0,\r\n        label: 'Maschio'\r\n      },\r\n      {\r\n        value: 1,\r\n        label: 'Femmina'\r\n      }\r\n    ];\r\n  };\r\n\r\n  private renderButtonChangePassword = () => {\r\n    return (\r\n      <Button onClick={this._onChangePassword} type=\"primary\" size=\"small\" style={{ width: '100%' }}>\r\n        Modifica\r\n      </Button>\r\n    );\r\n  };\r\n\r\n  private getInitialValueBirthDate = () => {\r\n    const { user } = this.props;\r\n    return user?.birth_date ? moment(user.birth_date).toDate() : undefined;\r\n  };\r\n\r\n  public render() {\r\n    const { user } = this.props;\r\n    const { getFieldProps } = this.props.form;\r\n    return (\r\n      <LocaleProvider locale={enUS}>\r\n        <div>\r\n          <List renderHeader={() => 'Area personale'}>\r\n            <InputItem\r\n              {...getFieldProps('username', {\r\n                initialValue: user?.username,\r\n                rules: [{ required: true, message: 'Specificare il nome utente' }]\r\n              })}\r\n              disabled\r\n              placeholder=\"Username\"\r\n            >\r\n              Username\r\n            </InputItem>\r\n            <div style={{ width: '100%' }}>\r\n              <div style={{ display: 'table-cell' }}>\r\n                <InputItem\r\n                  type=\"password\"\r\n                  disabled\r\n                  {...getFieldProps('password', {\r\n                    initialValue: `12345678`,\r\n                    rules: [{ required: true, message: 'Specificare la password' }]\r\n                  })}\r\n                  placeholder=\"Password\"\r\n                >\r\n                  Password\r\n                </InputItem>\r\n              </div>\r\n              <div style={{ display: 'table-cell' }}>{this.renderButtonChangePassword()}</div>\r\n            </div>\r\n          </List>\r\n          <WhiteSpace />\r\n          <List>\r\n            <InputItem\r\n              {...getFieldProps('name', {\r\n                initialValue: user?.name,\r\n                rules: [{ required: true, message: 'Specificare il Nome' }]\r\n              })}\r\n              clear\r\n              placeholder=\"Digitare il nome\"\r\n            >\r\n              Nome\r\n            </InputItem>\r\n            <InputItem\r\n              {...getFieldProps('surname', {\r\n                initialValue: user?.surname,\r\n                rules: [{ required: true, message: 'Specificare il Cognome' }]\r\n              })}\r\n              clear\r\n              placeholder=\"Digitare il cognome\"\r\n            >\r\n              Cognome\r\n            </InputItem>\r\n            <DatePicker\r\n              minDate={new Date(1900, 1, 1)}\r\n              maxDate={new Date()}\r\n              mode=\"date\"\r\n              okText=\"Conferma\"\r\n              dismissText=\"Annulla\"\r\n              {...getFieldProps('birth_date', {\r\n                initialValue: this.getInitialValueBirthDate(),\r\n                rules: []\r\n              })}\r\n            >\r\n              <List.Item arrow=\"horizontal\">Data di nascita</List.Item>\r\n            </DatePicker>\r\n          </List>\r\n          <Picker\r\n            data={this.getPickerGenderData()}\r\n            title=\"Seleziona il sesso\"\r\n            okText=\"Conferma\"\r\n            dismissText=\"Annulla\"\r\n            cols={1}\r\n            {...getFieldProps('gender', {\r\n              initialValue: [user?.gender],\r\n              rules: [\r\n                {\r\n                  required: true,\r\n                  message: 'Specificare il sesso'\r\n                }\r\n              ]\r\n            })}\r\n          >\r\n            <List.Item arrow=\"horizontal\">Sesso</List.Item>\r\n          </Picker>\r\n          <List>\r\n            <InputItem\r\n              {...getFieldProps('email', {\r\n                initialValue: user?.email,\r\n                rules: []\r\n              })}\r\n              clear\r\n              placeholder=\"Specificare l'email personale\"\r\n            >\r\n              Email\r\n            </InputItem>\r\n            <InputItem\r\n              {...getFieldProps('cellphoneNumber', {\r\n                initialValue: user?.cellphoneNumber,\r\n                rules: []\r\n              })}\r\n              clear\r\n              placeholder=\"Specificare numero di cellulare\"\r\n            >\r\n              Cellulare\r\n            </InputItem>\r\n          </List>\r\n          <List.Item>\r\n            <Button type=\"primary\" icon=\"check-circle-o\" size=\"small\" onClick={this._onSubmit}>\r\n              Salva\r\n            </Button>\r\n          </List.Item>\r\n          <ChangePasswordModal\r\n            changePasswordModalVisible={this.state.passwordChangeFormVisible}\r\n            onPasswordChangeCancel={this._onPasswordChangeCancel}\r\n            onPasswordChangeConfirm={this._onPasswordChangeConfirm}\r\n          />\r\n        </div>\r\n      </LocaleProvider>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    connector: state.appData.connector,\r\n    committee: state.appData.committee\r\n  };\r\n};\r\n\r\nconst PersonalAreaMobileForm = createForm()(PersonalAreaMobile);\r\n\r\nconst PersonalAreaMobileContainer = connect(mapStateToProps, {\r\n  setUserData\r\n})(PersonalAreaMobileForm);\r\n\r\nexport default PersonalAreaMobileContainer;\r\n","import React from 'react';\r\nimport { Route } from 'react-router-dom';\r\nimport { TabBar, NavBar, Icon as IconMobile, Popover, Modal } from 'antd-mobile';\r\nimport { connect } from 'react-redux';\r\nimport { Icon, message } from 'antd';\r\nimport { PORTAL_NAME } from '../../utils/Constants';\r\nimport { Links } from '../../utils/Links';\r\nimport { WithUser, WithCommittee, WithConnector } from '../../reducers/reducers';\r\nimport { ResetAuthDataProps, resetAuthData } from '../../actions/action';\r\nimport { RouterProps } from 'react-router';\r\nimport TripDTO from '../../dto/TripDTO';\r\nimport PersonalAreaMobileContainer from './PersonalAreaMobile';\r\nimport TripUsersDTO from '../../dto/TripUsersDTO';\r\nimport { filterTripsByOccupation } from '../../utils/Utils';\r\nimport TripsList, { TripListType } from './base/TripsList';\r\n\r\nconst alert = Modal.alert;\r\nconst Item = Popover.Item;\r\n\r\nenum RightTopMenuChoise {\r\n  Logout = '1'\r\n}\r\n\r\ninterface DashboardMobileState {\r\n  selectedTab: 'servicesTab' | 'bookedServicesTab' | 'personalAreaTab';\r\n  hidden: boolean;\r\n  rightTopMenuVisible: boolean;\r\n  isLoading: boolean;\r\n  availableTrips: TripDTO[];\r\n  bookedTrips: TripDTO[];\r\n}\r\n\r\ninterface DashbardMobileProps extends WithUser, WithCommittee, WithConnector, ResetAuthDataProps, RouterProps {}\r\n\r\nclass DashboardMobile extends React.Component<DashbardMobileProps, DashboardMobileState> {\r\n  constructor(props: any) {\r\n    super(props);\r\n\r\n    const { user, committee } = this.props;\r\n    if (!user && !committee) {\r\n      this._onLogout();\r\n    }\r\n\r\n    this.state = {\r\n      selectedTab: 'servicesTab',\r\n      hidden: false,\r\n      rightTopMenuVisible: false,\r\n      isLoading: true,\r\n      availableTrips: [],\r\n      bookedTrips: []\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loadData();\r\n  }\r\n\r\n  private loadData = () => {\r\n    this.setState({ isLoading: true }, () => {\r\n      const { connector, user } = this.props;\r\n      let allTrips: [Promise<any>, Promise<any>] = [connector.getAvailableTrips(), connector.getBookedTrips()];\r\n      Promise.all(allTrips)\r\n        .then((results: any[]) => {\r\n          const availableTrips: TripDTO[] = (results[0] || []).data\r\n            .filter((trip: TripDTO) => trip.extraUsers + 1 !== trip.trip_users?.length)\r\n            .filter((trip: TripDTO) => filterTripsByOccupation(trip, user));\r\n          const bookedTrips: TripDTO[] = results[1].data || [];\r\n          this.setState({\r\n            availableTrips,\r\n            bookedTrips,\r\n            isLoading: false\r\n          });\r\n        })\r\n        .catch((err: any) => {\r\n          console.error(err);\r\n          this.setState({ availableTrips: [], bookedTrips: [], isLoading: false });\r\n        });\r\n    });\r\n  };\r\n\r\n  _onLogout = () => {\r\n    this.props.history.replace({\r\n      pathname: Links.MOBILE_LOGIN\r\n    });\r\n  };\r\n\r\n  renderTabContent() {\r\n    if (this.state.isLoading) {\r\n      return <div style={{ textAlign: 'center', marginTop: '10px' }}>Caricamento in corso...</div>;\r\n    }\r\n    return (\r\n      <div style={{ height: '100%', textAlign: 'center' }}>\r\n        <Route\r\n          path={Links.MOBILE_SERVICES}\r\n          component={() => (\r\n            <TripsList trips={this.state.availableTrips} tripListType={TripListType.toBook} user={this.props.user} onBookTrip={this._onBookTrip} />\r\n          )}\r\n        />\r\n        <Route\r\n          path={Links.MOBILE_BOOKED_SERVICES}\r\n          component={() => (\r\n            <TripsList trips={this.state.bookedTrips} tripListType={TripListType.booked} user={this.props.user} onCancelBookTrip={this._onCancelBookTrip} />\r\n          )}\r\n        />\r\n        <Route path={Links.MOBILE_PERSONAL_AREA} exact={true} component={PersonalAreaMobileContainer} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onCancelBookTrip = (trip: TripDTO): void => {\r\n    alert('Attenzione', `Sicuro di voler annullare la prenotazione per il viaggio selezionato?`, [\r\n      {\r\n        text: 'Annulla',\r\n        onPress: () => {\r\n          /* Do nothing */\r\n        }\r\n      },\r\n      { text: 'Ok', onPress: () => this._onClickCancelBookTrip(trip) }\r\n    ]);\r\n  };\r\n\r\n  private _onClickCancelBookTrip = (trip: TripDTO): void => {\r\n    const { user } = this.props;\r\n    const tripUserToDelete: TripUsersDTO | undefined = (trip.trip_users || []).find((tripUser: TripUsersDTO) => tripUser.userId === user?.id);\r\n    if (tripUserToDelete !== undefined) {\r\n      const tripUserId: number = tripUserToDelete.id;\r\n      this.props.connector\r\n        .deleteTripUsers(tripUserId)\r\n        .then((res) => {\r\n          this.loadData();\r\n        })\r\n        .catch((err) => {\r\n          console.error(`_onDeleteTripUser: ${err}`);\r\n          message.error(`Si è verificato un errore nell'eliminazione`);\r\n        });\r\n    } else {\r\n      message.error(`Si è verificato un errore nella richiesta`);\r\n    }\r\n  };\r\n\r\n  private _onBookTrip = (trip: TripDTO, role: number, userId: number): void => {\r\n    const tripToPublish: TripUsersDTO = {\r\n      id: 0,\r\n      tripId: trip.id,\r\n      userId,\r\n      role\r\n    };\r\n    this.setState({ isLoading: true });\r\n    this.props.connector\r\n      .publishTripUser(tripToPublish)\r\n      .then((res) => {\r\n        message.success('Prenotazione effettuata con successo');\r\n        this.setState({ isLoading: false }, () => {\r\n          this.loadData();\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        let errorMessage = 'Si è verificato un errore nella richiesta';\r\n        if (err.response && err.response.data && err.response.data.message) {\r\n          errorMessage = err.response.data.message;\r\n        }\r\n        this.setState({ isLoading: false }, () => {\r\n          message.error(errorMessage);\r\n        });\r\n      });\r\n  };\r\n\r\n  private _onClickLogout = () => {\r\n    this.props.resetAuthData();\r\n    this._onLogout();\r\n  };\r\n\r\n  private _onSelectRightTopMenu = (node: any, index?: number) => {\r\n    switch (node.key) {\r\n      case RightTopMenuChoise.Logout:\r\n        alert('Attenzione', `Sicuro di voler uscire?`, [\r\n          {\r\n            text: 'Annulla',\r\n            onPress: () => {\r\n              /* Do nothing */\r\n            }\r\n          },\r\n          { text: 'Ok', onPress: () => this._onClickLogout() }\r\n        ]);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.setState({\r\n      rightTopMenuVisible: false\r\n    });\r\n  };\r\n\r\n  private _rightTopMenuVisibleChange = (rightTopMenuVisible: boolean) => {\r\n    this.setState({\r\n      rightTopMenuVisible\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { committee } = this.props;\r\n    return (\r\n      <div>\r\n        <NavBar\r\n          mode=\"dark\"\r\n          leftContent={<span style={{ fontSize: '12px', fontWeight: 'bold' }}>{PORTAL_NAME}</span>}\r\n          rightContent={[\r\n            <Icon key=\"0\" type=\"reload\" style={{ marginRight: '5px' }} onClick={this.loadData} />,\r\n            <Popover\r\n              key=\"1\"\r\n              visible={this.state.rightTopMenuVisible}\r\n              overlay={[<Item key={RightTopMenuChoise.Logout}>Logout</Item>]}\r\n              onVisibleChange={this._rightTopMenuVisibleChange}\r\n              onSelect={this._onSelectRightTopMenu}\r\n            >\r\n              <div\r\n                style={{\r\n                  height: '100%',\r\n                  padding: '0 15px',\r\n                  marginRight: '-15px',\r\n                  display: 'flex',\r\n                  alignItems: 'center'\r\n                }}\r\n              >\r\n                <IconMobile type=\"ellipsis\" />\r\n              </div>\r\n            </Popover>\r\n          ]}\r\n        >\r\n          <span style={{ fontSize: '12px' }}>{committee?.description}</span>\r\n        </NavBar>\r\n        <div style={{ position: 'fixed', height: 'calc(100% - 45px)', width: '100%', top: 45 }}>\r\n          <TabBar\r\n            unselectedTintColor=\"#949494\"\r\n            tintColor=\"#33A3F4\"\r\n            barTintColor=\"white\"\r\n            tabBarPosition=\"bottom\"\r\n            hidden={this.state.hidden}\r\n            prerenderingSiblingsNumber={0}\r\n          >\r\n            <TabBar.Item\r\n              title=\"Servizi disponibili\"\r\n              key=\"Servizi\"\r\n              icon={<Icon type=\"calendar\" />}\r\n              selectedIcon={<Icon type=\"calendar\" />}\r\n              selected={this.state.selectedTab === 'servicesTab'}\r\n              badge={this.state.availableTrips.length}\r\n              onPress={() => {\r\n                this.setState(\r\n                  {\r\n                    selectedTab: 'servicesTab'\r\n                  },\r\n                  () => this.props.history.replace(Links.MOBILE_SERVICES)\r\n                );\r\n              }}\r\n              data-seed=\"logId\"\r\n            >\r\n              {this.renderTabContent()}\r\n            </TabBar.Item>\r\n            <TabBar.Item\r\n              title=\"Servizi prenotati\"\r\n              key=\"booked_services\"\r\n              icon={<Icon type=\"book\" />}\r\n              selectedIcon={<Icon type=\"book\" />}\r\n              selected={this.state.selectedTab === 'bookedServicesTab'}\r\n              badge={this.state.bookedTrips.length}\r\n              onPress={() => {\r\n                this.setState(\r\n                  {\r\n                    selectedTab: 'bookedServicesTab'\r\n                  },\r\n                  () => this.props.history.replace(Links.MOBILE_BOOKED_SERVICES)\r\n                );\r\n              }}\r\n              data-seed=\"logId1\"\r\n            >\r\n              {this.renderTabContent()}\r\n            </TabBar.Item>\r\n            <TabBar.Item\r\n              title=\"Area personale\"\r\n              key=\"personal_area\"\r\n              icon={<Icon type=\"user\" />}\r\n              selectedIcon={<Icon type=\"user\" />}\r\n              selected={this.state.selectedTab === 'personalAreaTab'}\r\n              onPress={() => {\r\n                this.setState(\r\n                  {\r\n                    selectedTab: 'personalAreaTab'\r\n                  },\r\n                  () => this.props.history.replace(Links.MOBILE_PERSONAL_AREA)\r\n                );\r\n              }}\r\n              data-seed=\"logId2\"\r\n            >\r\n              {this.renderTabContent()}\r\n            </TabBar.Item>\r\n          </TabBar>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: any, ownProps: any) => {\r\n  return {\r\n    user: state.appData.user,\r\n    committee: state.appData.committee,\r\n    connector: state.appData.connector\r\n  };\r\n};\r\n\r\nconst DashboardMobileContainer = connect(mapStateToProps, { resetAuthData })(DashboardMobile);\r\nexport default DashboardMobileContainer;\r\n","import React from 'react';\r\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\r\nimport { Links } from './utils/Links';\r\nimport LoginContainer from './components/common/Login';\r\nimport DashboardContainer from './components/desktop/Dashboard';\r\nimport DashboardMobileContainer from './components/mobile/DashboardMobile';\r\n\r\nclass App extends React.Component {\r\n  public render() {\r\n    return (\r\n      <Router>\r\n        <Switch>\r\n          <Route exact={true} path={Links.LOGIN} component={LoginContainer} />\r\n          <Route exact={true} path={Links.MOBILE_LOGIN} component={LoginContainer} />\r\n          <Route path={Links.DESKTOP} component={DashboardContainer} />\r\n          <Route path={[Links.MOBILE_SERVICES, Links.MOBILE_BOOKED_SERVICES, Links.MOBILE_PERSONAL_AREA]} component={DashboardMobileContainer} />\r\n        </Switch>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport 'antd/dist/antd.css';\r\nimport 'antd-mobile/dist/antd-mobile.css';\r\nimport { createStore } from 'redux';\r\nimport AppReducers from './reducers/reducers';\r\nimport { Provider } from 'react-redux';\r\nimport App from './App';\r\n\r\nexport function configureStore() {\r\n  const store = createStore(AppReducers);\r\n  return store;\r\n}\r\n\r\nReactDOM.render(\r\n  <Provider store={configureStore()}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root') as HTMLElement\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}